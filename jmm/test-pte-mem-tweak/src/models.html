

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EOS Models &mdash; Singularity-EOS  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Equation of State Modifiers" href="modifiers.html" />
    <link rel="prev" title="The Equation of State API" href="using-eos.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Singularity-EOS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building <cite>singularity-eos</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">Integrating <cite>singularity-eos</cite> into a CMake project</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-eos.html">The Equation of State API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">EOS Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#eos-theory">EOS Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-mie-gruneisen-form">The Mie-Gruneisen form</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-notes-on-thermodynamic-consistency">Some Notes on Thermodynamic Consistency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-3t-model">The 3T Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#available-eos-information-and-nomenclature">Available EOS Information and Nomenclature</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#entropy-availability">Entropy availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nomenclature-disambiguation">Nomenclature Disambiguation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-gruneisen-parameter">The Gruneisen Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#units-and-conversions">Units and conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-meanatomicproperties-struct">The <code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implemented-eos-models">Implemented EOS models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ideal-gas">Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal-electron-gas">Ideal Electron Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stiffened-gas">Stiffened Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#noble-abel">Noble-Abel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#carnahan-starling">Carnahan-Starling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gruneisen-eos">Gruneisen EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extendended-vinet-eos">Extendended Vinet EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mie-gruneisen-linear-u-s-u-p-eos">Mie-Gruneisen linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mie-gruneisen-power-expansion-eos">Mie-Gruneisen power expansion EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jwl-eos">JWL EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#davis-eos">Davis EOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#davis-reactants-eos">Davis Reactants EOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#davis-products-eos">Davis Products EOS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spiner-eos">Spiner EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sp5-files-and-sesame2spiner"><code class="docutils literal notranslate"><span class="pre">sp5</span></code> files and <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#piecewise-spiner-grids">Piecewise Spiner Grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sap-polynomial-eos">SAP Polynomial EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stellar-collapse-eos">Stellar Collapse EOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv44SaveRKNSt6stringE"><code class="docutils literal notranslate"><span class="pre">Save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK35MassFractionsFromDensityTemperatureEK4RealK4RealR4RealR4RealR4RealR4RealR4RealP4Real"><code class="docutils literal notranslate"><span class="pre">MassFractionsFromDensityTemperature()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#helmholtz-eos">Helmholtz EOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eospac-eos">EOSPAC EOS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modifiers.html">Equation of State Modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customizing <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="using-closures.html">Mixed Cell Closures</a></li>
<li class="toctree-l1"><a class="reference internal" href="using-kpt.html">Kinetic Phase Transition Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="fortran.html">Fortran Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinx-doc.html">How to Use Sphinx for Writing Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Singularity-EOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">EOS Models</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/src/models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="models"></span><section id="eos-models">
<h1>EOS Models<a class="headerlink" href="#eos-models" title="Link to this heading"></a></h1>
<p>The mathematical descriptions of these models are presented below while the
details of using them is presented in the description of the
<a class="reference internal" href="using-eos.html"><span class="doc">EOS API</span></a>.</p>
<section id="eos-theory">
<h2>EOS Theory<a class="headerlink" href="#eos-theory" title="Link to this heading"></a></h2>
<p>An equation of state (EOS) is a constituitive model that generally relates
thermodynamic quantities such as pressure, temperature, density, internal
energy, free energy, and entropy consistent with the constraints of equillibrium
thermodynamics.</p>
<p><code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> contains a number of equations of state that are most useful
in hydrodynamics codes. All of the equations of state presented here are
considered “complete” equations of state in the sense that they contain all the
information needed to derive a given thermodynamic quantity. However, not all
variables are exposed since the emphasis is on only those that are needed for
hydrodynamics codes. An incomplete equation of state is often sufficient for
pure hydrodynamics since it can relate pressure to a given energy-density state,
but it is missing thermal information (see the section on <a class="reference internal" href="#complete-eos"><span class="std std-ref">complete
equations of state</span></a>).</p>
<p>An excellent resource on equations of state in the context of hydrodynamics is
the seminal work from <a class="reference external" href="https://doi.org/10.1103/RevModPhys.61.75">Menikoff and Plohr</a>. In particular,
Appendix A contains a number of thermodynamic relationships that can be useful
for computing additional quantities from those output in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code>.</p>
<section id="the-mie-gruneisen-form">
<h3>The Mie-Gruneisen form<a class="headerlink" href="#the-mie-gruneisen-form" title="Link to this heading"></a></h3>
<p>Many of the following equations of state are considered to be of
the “Mie-Gruneisen form”, which has many implications but for our purposes
means that the general form of the EOS is</p>
<div class="math notranslate nohighlight">
\[P - P_\mathrm{ref} = \rho \Gamma(\rho) (e - e_\mathrm{ref})\]</div>
<p>where ‘ref’ denotes quantities along some reference curve, <span class="math notranslate nohighlight">\(P\)</span> is the
pressure, <span class="math notranslate nohighlight">\(\rho\)</span> is the density, <span class="math notranslate nohighlight">\(\Gamma\)</span> is the Gruneisen
parameter, and <span class="math notranslate nohighlight">\(e\)</span> is the specific internal energy. In this sense, an EOS
of this form uses the Gruneisen parameter to describe the pressure behavior of
the EOS away from the reference curve. Coupled with a relationship between
energy and temperature (sometimes as simple as a constant heat capacity), the
complete equation of state can be constructed.</p>
<p>To some degree it is the complexity of the reference state and the heat
capacity that will determine an EOS’s ability to capture the complex behavior of
a material. At the simplest level, the ideal gas EOS uses a reference state at
zero pressure and energy, while more complex equations of state such as the
Davis EOS use the material’s isentrope. In ths way, the reference curve
indicates the conditions under which you can expect the EOS to represent the
intended behavior.</p>
</section>
<section id="some-notes-on-thermodynamic-consistency">
<h3>Some Notes on Thermodynamic Consistency<a class="headerlink" href="#some-notes-on-thermodynamic-consistency" title="Link to this heading"></a></h3>
<p id="complete-eos">For the pure purpose of solving the Euler equations, an incomplete equation of
state of the form <span class="math notranslate nohighlight">\(P(\rho, e)\)</span> is sufficient. In essence, this provides the
mechanical response of a material subjected to different types of compression
and expansion. However, this EOS is lacking <em>thermal</em> information without an
appropriate heat capacity relationship.</p>
<p>As discussed <a class="reference external" href="https://www.osti.gov/biblio/1561015">by Mattsson</a>, an equation of state can be
considered “complete” if it is constructed from one of the thermodynamic
potentials using their <em>natural variables</em>, i.e.</p>
<div class="math notranslate nohighlight">
\[\begin{split}e =&amp; e(\rho, S) \\
h =&amp; h(P, S) \\
F =&amp; F(\rho, T) \\
G =&amp; G(P, T) \\\end{split}\]</div>
<p>where all potentials are specific. Here <span class="math notranslate nohighlight">\(e\)</span> is again the internal energy,
<span class="math notranslate nohighlight">\(h\)</span> is the enthalpy, <span class="math notranslate nohighlight">\(F\)</span> is the Helmholtz free energy, and <span class="math notranslate nohighlight">\(G\)</span>
is the Gibbs free energy. While equations of state formulated using the
Helmholtz free energy can be particularly attractive (such as the sesame
tables), finding a convenient form can be difficult. As such, it becomes
imperitive to extend the Mie-Gruneisen form so that it can form a complete
EOS.</p>
<p>The heat capacity is defined as</p>
<div class="math notranslate nohighlight">
\[C_V := \left(\frac{\partial e}{\partial T}\right)_V
     = T \left(\frac{\partial S}{\partial T}\right)_V\]</div>
<p>which provides a natural means by which to relate the entropy/energy to the
temperature and form a complete equation of state. However, there are
specific requirements placed on the functional form of the heat capacity
described below.</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Maxwell_relations">Maxwell relations</a> are the consequence of the
requirement that mixed partial second derivatives of the thermodynamic
potentials should be independent of the order of differentiation. This concept
can be extended to third derivatives (as Davis does in his Appendix B <a class="reference external" href="https://doi.org/10.1016/S0010-2180(99)00112-1">here</a>) to produce the relationship,</p>
<div class="math notranslate nohighlight">
\[\frac{V}{C_V^2}\left(\frac{\partial C_V}{\partial V}\right)_S =
  \left(\frac{\partial \Gamma}{\partial S}\right)_V.\]</div>
<p>This is often referred to as a “compatibility condition” (see also
<a class="reference external" href="https://www.osti.gov/biblio/1241653">Menikoff</a>) and provides an important connection
between the Gruneisen parameter, <span class="math notranslate nohighlight">\(\Gamma\)</span>, and the constant volume heat
capacity, <span class="math notranslate nohighlight">\(C_V\)</span>, in the context of a complete equation of state
developed from the internal energy. Importantly, if the Gruneisen form forces
us to assume that the Gruneisen parameter is a sole function of
density/volume, then the implication is that the heat capacity <strong>*must*</strong> then
be a sole function of entropy.</p>
<p>Again from <a class="reference external" href="https://www.osti.gov/biblio/1241653">Menikoff</a>, it can be shown that even
in the simplest possible case of a constant heat capacity, the temperature
is related to the energy through</p>
<div class="math notranslate nohighlight">
\[T(\rho, e) = T_0 \phi(\rho) + \frac{e - e_{S,0}(\rho)}{C_V}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_0\)</span> represents a reference temperature, <span class="math notranslate nohighlight">\(e_{S,0}\)</span> is the
energy along the isentrope that passes through the reference temperature, and
<span class="math notranslate nohighlight">\(\phi(\rho)\)</span> is an integrating factor given by</p>
<div class="math notranslate nohighlight">
\[\phi(\rho) = \exp\left(\int\limits_{\rho_0}^{\rho} \rho \Gamma
 (\rho) \mathrm{d}\rho \right).\]</div>
<p>As an EOS of a Mie-Gruneisen form becomes more complicated with more complex
functional forms for <span class="math notranslate nohighlight">\(\Gamma\)</span> and the reference curves, the task of
calculating a <strong>thermodynamically consistent</strong> temperature becomes more
complicated.</p>
</section>
<section id="the-3t-model">
<span id="t-model"></span><h3>The 3T Model<a class="headerlink" href="#the-3t-model" title="Link to this heading"></a></h3>
<p>In high-energy density physics, the so-called three-temperature (or
3T) model is often employed. In this model, a material is fully or
partially ionized. Due to the separation in masses between electrons
and atomic nuclei, electrons come into thermal equilibrium and ions
come into thermal equilibrium, but the two populations are not in
thermal equilibrium with each other. This introduces separate electron
and ion temperatures. The third temperature is potentially a radiation
temperature.</p>
<p>By convention in 3T physics, density <span class="math notranslate nohighlight">\(\rho\)</span> is always the mass
density of the ions. The electron number density may then be computed
as</p>
<div class="math notranslate nohighlight">
\[n = \left\langle Z \right\rangle \frac{\rho}{\overline{A} m_p}\]</div>
<p>where here <span class="math notranslate nohighlight">\(\left\langle Z\right\rangle\)</span> is the average number
of electrons contributed per atom, also called mean ionization state,
<span class="math notranslate nohighlight">\(\rho\)</span> is the ion mass density, <span class="math notranslate nohighlight">\(\overline{A}\)</span> is the mean
atomic mass (in grams per mole) of a given material and <span class="math notranslate nohighlight">\(m_p\)</span> is
the proton mass.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that there is notational ambiguity between the average
ionization state and the average atomic number, as the symbol for
both is <span class="math notranslate nohighlight">\(Z\)</span>. To disambiguate in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code>, we use
overbars to reference mean atomic properties such as mean atomic
mass <span class="math notranslate nohighlight">\(\overline{A}\)</span> and mean atomic number <span class="math notranslate nohighlight">\(\overline{Z}\)</span> while we
use <span class="math notranslate nohighlight">\(\left\langle Z\right\rangle\)</span> to denote mean ionizaiton
state.</p>
</div>
<p>Also, since the electron mass is negligible compared to the ion mass,
the specific internal energy carried by electrons
<span class="math notranslate nohighlight">\(\varepsilon_e\)</span> is specific with respect to the <em>ion</em> mass. In
particular:</p>
<div class="math notranslate nohighlight">
\[u_e = \varepsilon_e \rho\]</div>
<p>where here <span class="math notranslate nohighlight">\(u_e\)</span> is the internal energy per unit volume carried
by electrons and, as discussed above, <span class="math notranslate nohighlight">\(\rho\)</span> is ion mass
density.</p>
<p><code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> assumes that, when 3T physics is active, electrons
and ions are each described by a separate equation of state
object. Several models are specifically designed to represent, e.g.,
the electron equation of state or ion equation of state.</p>
<p>The tabulated models may also support loading tables specifically for
electron or ion equations of state. In these cases, an <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">class</span></code>
specifies which component of the material is being requst:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">TableSplit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Total</span><span class="p">,</span><span class="w"> </span><span class="n">ElectronOnly</span><span class="p">,</span><span class="w"> </span><span class="n">IonCold</span><span class="w"> </span><span class="p">};</span>
</pre></div>
</div>
<p>where here <code class="docutils literal notranslate"><span class="pre">ElectronOnly</span></code> is the free electrons of the material,
corresponding to Sesame 304 tables, <code class="docutils literal notranslate"><span class="pre">IonCold</span></code> is the ions plus cold
curve (i.e., the ions if you don’t know what a cold curve is),
corresponding to the Sesame 303 tables, and <code class="docutils literal notranslate"><span class="pre">Total</span></code> is the sum of
free electrons and ions, correspodning to the Sesame 301 tables.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tabulated equations of state have an implicitly assumed
ionization fraction that depends on the electron temperature.</p>
</div>
</section>
</section>
<section id="available-eos-information-and-nomenclature">
<h2>Available EOS Information and Nomenclature<a class="headerlink" href="#available-eos-information-and-nomenclature" title="Link to this heading"></a></h2>
<p>The EOS models in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> are defined for the following sets of
dependent and independent variables through various member functions described
in the <a class="reference internal" href="using-eos.html"><span class="doc">EOS API</span></a>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Dependent Variable</p></th>
<th class="head"><p>Independent Variables</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T(\rho, e)\)</span></p></td>
<td><p>Temperature</p></td>
<td rowspan="3"><p>Density, Specific
Internal Energy</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(P(\rho, e)\)</span></p></td>
<td><p>Pressure</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(S(\rho, e)\)</span></p></td>
<td><p>Specific Entropy</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(e(\rho, T)\)</span></p></td>
<td><p>Specific Internal
Energy</p></td>
<td rowspan="3"><p>Density, Temperature</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P(\rho, T)\)</span></p></td>
<td><p>Pressure</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S(\rho, T)\)</span></p></td>
<td><p>Specific Entropy</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho(P, T)\)</span> <a class="footnote-reference brackets" href="#pt" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>Density</p></td>
<td rowspan="2"><p>Pressure, <a class="footnote-reference brackets" href="#pt" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>
Temperature <a class="footnote-reference brackets" href="#pt" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(e(P, T)\)</span> <a class="footnote-reference brackets" href="#pt" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>Specific Internal
Energy</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_V(\rho, T)\)</span></p></td>
<td rowspan="2"><p>Constant Volume
Specific Heat
Capacity</p></td>
<td><p>Density, Temperature</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C_V(\rho, e)\)</span></p></td>
<td><p>Density, Specific
Internal Energy</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(B_S(\rho, T)\)</span></p></td>
<td rowspan="2"><p>Isentropic Bulk
Modulus</p></td>
<td><p>Density, Temperature</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(B_S(\rho, e)\)</span></p></td>
<td><p>Density, Specific
Internal Energy</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Gamma(\rho, T)\)</span></p></td>
<td rowspan="2"><p>Gruneisen Parameter</p></td>
<td><p>Density, Temperature</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Gamma(\rho, e)\)</span></p></td>
<td><p>Density, Specific
Internal Energy</p></td>
</tr>
</tbody>
</table>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="pt" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>,<a role="doc-backlink" href="#id3">3</a>,<a role="doc-backlink" href="#id4">4</a>)</span>
<p>Note: Using pressure and temperature as independent variables is fraught
since both pressure and energy are often multi-valued in density for many
EOS due to the presence of phase changes (especially tabular EOS). For
analytic EOS in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> where there is not an analytic inversion
to pressure-temperature space, a root-find is typically used that uses the
density at standard temperature and pressure (STP) as an initial guess. The
notable exceptions to this are the spiner EOS that allow the introduction of
an initial guess via the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function argument.</p>
</aside>
</aside>
<p>A point of note is that “specific” implies that the quantity is intensive on a
per unit mass basis. It should be assumed that the internal energy and entopry
are <em>always</em> specific since we are working in terms of density (the inverse of
specific volume).</p>
<section id="entropy-availability">
<h3>Entropy availability<a class="headerlink" href="#entropy-availability" title="Link to this heading"></a></h3>
<p>For an arbitrary equation of state, a change in entropy in terms of temperature
and volume is given by</p>
<div class="math notranslate nohighlight">
\[\Delta S = \int\limits_{S_0}^{S} \mathrm{d}S =
    \int\limits_{T_0}^{T} \left(\frac{\partial S}{\partial T}\right)_V
    \mathrm{d}T
    + \int\limits_{V_0}^{V} \left(\frac{\partial S}{\partial V}\right)_T
    \mathrm{d}V,\]</div>
<p>which can be simplified using a definition of the heat capacity and a Maxwell
relation to become</p>
<div class="math notranslate nohighlight">
\[\Delta S =
    \int\limits_{T_0}^{T} \frac{C_V}{T} \mathrm{d}T
    + \int\limits_{V_0}^{V} \left(\frac{\partial P}{\partial T}\right)_V
    \mathrm{d}V.\]</div>
<p>Similarly, expressing the entropy in terms of <em>energy</em> and volume yields</p>
<div class="math notranslate nohighlight">
\[\Delta S =
    \int\limits_{e_0}^{e} \frac{1}{T(\rho, e)} \mathrm{d}e
    + \int\limits_{V_0}^{V} \frac{P(\rho, e)}{T(\rho, e)}
    \mathrm{d}V\]</div>
<p>after substituting for the appropriate derivatives using the first law of
thermodynamics.</p>
<p>Importantly for the analytic EOS, these integrals will tend to diverge as the
temperature and volume approach zero if the heat capacity does not also
approach zero. This necessitates appropriate choices for the reference
states <span class="math notranslate nohighlight">\(T_0\)</span> and <span class="math notranslate nohighlight">\(V_0\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All EOS objects will expose the functions
<code class="code docutils literal notranslate"><span class="pre">EntropyFromDensityInternalEnergy</span> <span class="pre">()</span></code> and
<code class="code docutils literal notranslate"><span class="pre">EntropyFromDensityTemperature()</span></code> but many EOS cannot currently
calculate entropy, either because the EOS is not thermodynamically
consistent or because the feature has not yet been implemented. In these
cases, the use of these functions will abort the calculation or raise an
exception depending on the execution space (host or device). The cases where
this occurs are noted below.</p>
</div>
</section>
<section id="nomenclature-disambiguation">
<h3>Nomenclature Disambiguation<a class="headerlink" href="#nomenclature-disambiguation" title="Link to this heading"></a></h3>
<section id="the-gruneisen-parameter">
<h4>The Gruneisen Parameter<a class="headerlink" href="#the-gruneisen-parameter" title="Link to this heading"></a></h4>
<p>In this description of the EOS models, we use <span class="math notranslate nohighlight">\(\Gamma\)</span> to represent the
Gruneisen coeficient since this is the most commonly-used symbol in the
context of Mie-Gruneisen equations of state. The definition of the Gruneisen
parameter is</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\Gamma := \frac{1}{\rho} \left( \frac{\partial P}{\partial e} \right)_\rho\]</div>
</div></blockquote>
<p>This should be differentiated from</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\gamma := \frac{V}{P} \left( \frac{\partial P}{\partial V} \right)_S =
        \frac{B_S}{P}\]</div>
</div></blockquote>
<p>though, which is the adiabatic exponent.</p>
<p>For an ideal gas, the adiabatic exponent is simply the ratio of the heat
capacities,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\gamma_\mathrm{id} = \frac{C_P}{C_V} = \frac{B_S}{B_T}.\]</div>
</div></blockquote>
<p>Here <span class="math notranslate nohighlight">\(C_P\)</span> is the specific heat capacity at constant <em>pressure</em>
and <span class="math notranslate nohighlight">\(B_T\)</span> is the <em>isothermal</em> bulk modulus.</p>
</section>
</section>
</section>
<section id="units-and-conversions">
<h2>Units and conversions<a class="headerlink" href="#units-and-conversions" title="Link to this heading"></a></h2>
<p>The default units for <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> are cgs which results in the following
units for thermodynamic quantities:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>Default Units</p></th>
<th class="head"><p>cgµ conversion</p></th>
<th class="head"><p>mm-mg-µs conversion</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td><p>µbar</p></td>
<td><p>10<sup>-12</sup> Mbar</p></td>
<td><p>10<sup>-10</sup> GPa</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>g/cm<sup>3</sup></p></td>
<td><p>1</p></td>
<td><p>1 mg/mm<sup>3</sup></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e\)</span></p></td>
<td><p>erg/g</p></td>
<td><p>10<sup>-12</sup> Terg/g</p></td>
<td><p>10<sup>-10</sup> J/mg</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S\)</span></p></td>
<td><p>erg/g-K</p></td>
<td><p>10<sup>-12</sup> Terg/g-K</p></td>
<td><p>10<sup>-10</sup> J/mg-K</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>K</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C_V\)</span></p></td>
<td><p>erg/g/K</p></td>
<td><p>10<sup>-12</sup> Terg/g/K</p></td>
<td><p>10<sup>-10</sup> J/mg/K</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(B_S\)</span></p></td>
<td><p>µbar</p></td>
<td><p>10<sup>-12</sup> Mbar</p></td>
<td><p>10<sup>-10</sup> GPa</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Gamma\)</span></p></td>
<td><p>unitless</p></td>
<td><p>–</p></td>
<td><p>–</p></td>
</tr>
</tbody>
</table>
<p>Note: sometimes temperatures are measured in eV for which the conversion is
8.617333262e-05 eV/K.</p>
<p>Sesame units are equivalent to the mm-mg-µs unit system.</p>
</section>
<section id="the-meanatomicproperties-struct">
<h2>The <code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct<a class="headerlink" href="#the-meanatomicproperties-struct" title="Link to this heading"></a></h2>
<p>Several analytic equations of state optionally accept mean atomic mass
and number as physics properties. These are the average number of
nucleons and protons in a constituent nucleus respectively. They are
not necessarily integers, as a given material may be made up of
multiple kinds of atom. For example, dry air contains both nitrogen
and oxygen.</p>
<p>The mean atomic mass and number are frequently carried in the
container struct</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">MeanAtomicProperties</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Real</span><span class="w"> </span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// default is hydrogen</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">DEFAULT_ABAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">DEFAULT_ZBAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>

<span class="w">  </span><span class="n">PORTABLE_INLINE_FUNCTION</span>
<span class="w">  </span><span class="nf">MeanAtomicProperties</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">Abar_</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Zbar_</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Abar</span><span class="p">(</span><span class="n">Abar_</span><span class="p">),</span><span class="w"> </span><span class="n">Zbar</span><span class="p">(</span><span class="n">Zbar_</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="w">  </span><span class="n">PORTABLE_INLINE_FUNCTION</span>
<span class="w">  </span><span class="nf">MeanAtomicProperties</span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Abar</span><span class="p">(</span><span class="n">DEFAULT_ABAR</span><span class="p">),</span><span class="w"> </span><span class="n">Zbar</span><span class="p">(</span><span class="n">DEFAULT_ZBAR</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>which owns the atomic mass <code class="docutils literal notranslate"><span class="pre">Abar</span></code> and atomic number <code class="docutils literal notranslate"><span class="pre">Zbar</span></code>. You
may set these by constructing the struct or by setting the fields in a
pre-constructed struct. The defaults are for hydrogen.</p>
</section>
<section id="implemented-eos-models">
<h2>Implemented EOS models<a class="headerlink" href="#implemented-eos-models" title="Link to this heading"></a></h2>
<section id="ideal-gas">
<h3>Ideal Gas<a class="headerlink" href="#ideal-gas" title="Link to this heading"></a></h3>
<p>The ideal gas (aka perfect or gamma-law gas) model in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> takes
the form</p>
<div class="math notranslate nohighlight">
\[P = \Gamma \rho e\]</div>
<div class="math notranslate nohighlight">
\[e = C_V T,\]</div>
<p>where quantities are defined in the <a class="reference internal" href="#available-eos-information-and-nomenclature"><span class="std std-ref">nomenclature</span></a> section. A common point of confusion
is <span class="math notranslate nohighlight">\(\Gamma\)</span> versus <span class="math notranslate nohighlight">\(\gamma\)</span> with the latter being the adiabatic
exponent. For an ideal gas, they are related through</p>
<div class="math notranslate nohighlight">
\[\Gamma = \gamma - 1\]</div>
<p>Although this formulation differs from the traditional representation of the
ideal gas law as <span class="math notranslate nohighlight">\(P\tilde{V} = RT\)</span>, the forms are equivalent by
recognizing that <span class="math notranslate nohighlight">\(\Gamma = \frac{R}{\tilde{C_V}}\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is the
ideal gas constant in units of energy per mole per Kelvin and <span class="math notranslate nohighlight">\(\tilde
{C_\mathrm{V}}\)</span> is the <em>molar</em> heat capacity, relatable to the <em>specific</em> heat
capacity through the molecular weight of the gas. Since <span class="math notranslate nohighlight">\(\tilde{C_\mathrm
{V}} = \frac{5}{2} R\)</span> for a diatomic ideal gas, the corresponding Gruneisen
parameter should be 0.4.</p>
<p>The entropy for an ideal gas is given by</p>
<div class="math notranslate nohighlight">
\[S = C_V \ln\left(\frac{T}{T_0}\right) + \Gamma C_V \ln\left(\frac{\rho_0}
 {\rho}\right),\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The entropy diverges to negative infinity at absolute zero due to the
constant heat capacity assumption. Care should be taken when using
temperatures significantly below that of the reference state.</p>
</div>
<p>we have assumed that the entropy is zero at the reference state given
by <span class="math notranslate nohighlight">\(T_0\)</span> and <span class="math notranslate nohighlight">\(\rho_0\)</span>. By default, <span class="math notranslate nohighlight">\(T_0 = 298\)</span> K and the
reference density is given by</p>
<div class="math notranslate nohighlight">
\[\rho_0 = \frac{P_0}{\Gamma C_V T_0},\]</div>
<p>where <span class="math notranslate nohighlight">\(P_0 = 1\)</span> bar.</p>
<p>It should be noted that this equation diverges as the temperature approaches
zero or the density approaches infinity. From a physical perspective, this is a
limitation of the constant heat capacity assumption and would be remedied if
the heat capacity went to zero at absolute zero. However, this represents a
significant deviation from true ideal gas physics so we do not include it
here.</p>
<p>The settable parameters for this EOS are the Gruneisen parameter and specific
heat capacity. Optionally, the reference state for the entropy calculation can
be provided by setting <em>both</em> the reference density and temperature.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">IdealGas</span></code> EOS constructor has two arguments, <code class="docutils literal notranslate"><span class="pre">gm1</span></code>, which is
the Gruneisen parameter <span class="math notranslate nohighlight">\(\Gamma\)</span>, and <code class="docutils literal notranslate"><span class="pre">Cv</span></code>, which is the
specific heat <span class="math notranslate nohighlight">\(C_V\)</span>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">IdealGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the reference temperature and density for the entropy calculation,
can be provided in the constructor via <code class="docutils literal notranslate"><span class="pre">EntropyT0</span></code> and <code class="docutils literal notranslate"><span class="pre">EntropyRho0</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">IdealGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">EntropyT0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">EntropyRho0</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that these parameters are provided solely for the entropy calculation. When
these values are not set, they will be the same as those returned by the
<code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code> function. However, if the entropy reference
conditions are given, the return values of the <code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code>
function will not be the same.</p>
<p>Both constructors also optionally accept <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter, e.g.,</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">IdealGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
<span class="n">IdealGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">EntropyT0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">EntropyRho0</span><span class="p">,</span><span class="w"> </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="ideal-electron-gas">
<h3>Ideal Electron Gas<a class="headerlink" href="#ideal-electron-gas" title="Link to this heading"></a></h3>
<p>The ideal electron gas equation of state is designed for use with 3T
physics. It is an ideal Boltzmann gas of electrons. As such, each
electron is assumed to have three translational degrees of freedom
<span class="math notranslate nohighlight">\(f\)</span>, such that</p>
<div class="math notranslate nohighlight">
\[\Gamma = \frac{2}{f} = \frac{2}{3}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\gamma = \Gamma + 1 = \frac{5}{3}.\]</div>
<p>The pressure is given by the number density of electrons times
<span class="math notranslate nohighlight">\(k_b T\)</span> for Boltzmann constant <span class="math notranslate nohighlight">\(k_b\)</span> and temperature
<span class="math notranslate nohighlight">\(T\)</span>:</p>
<div class="math notranslate nohighlight">
\[P = \frac{\rho}{m_p \overline{A}}\left\langle Z \right\rangle k_b T\]</div>
<p>for proton mass <span class="math notranslate nohighlight">\(m_p\)</span>. The specific heat is then</p>
<div class="math notranslate nohighlight">
\[C_V = \frac{\left\langle Z \right\rangle k_b}{\Gamma m_p \overline{A}}\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[P = \Gamma \rho C_V T\]</div>
<p>as expected. (Note that the total mass per nucleus isn’t exactly
<span class="math notranslate nohighlight">\(\overline{A} m_p\)</span>, as protons and neutrons are
not exactly the same mass. However, it’s close enough for all intents
and purposes.)</p>
<p>The constructor takes only the <code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct, which
is a required input:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">IdealElectrons</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MeanAtomicProperties</span><span class="w"> </span><span class="o">&amp;</span><span class="n">AZbar</span><span class="p">);</span>
</pre></div>
</div>
<p>Optionally reference values may be provided for the entropy
calculation, which is computed in the same way as the standard ideal
gas.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the mean ionization state is built into the heat capacity, the
entropy is zero until the material is ionized. This is physically
consistent, if there are no electrons, the total electron entropy
should be zero.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The electron entropy reference should probably be chosen to be
consistent with the chosen ionization model, such as a reference
temperature where ionization begins. This is about <span class="math notranslate nohighlight">\(10^4\)</span>
Kelvin but will depend on the model and the material. This means
that the entropy reference temperature may be very different between
ions and electrons.</p>
</div>
<p>Calls to compute state variables require the mean ionization state,
which must be passed in the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> parameter, e.g.,</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Real</span><span class="w"> </span><span class="n">lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">Z</span><span class="p">};</span>
<span class="n">Real</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eos</span><span class="p">.</span><span class="n">PressureFromDensityTemperature</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="p">);</span>
</pre></div>
</div>
<p>If you use the indexable types machinery, this is named
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::MeanIonizationState</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, the ideal electron gas is not in the default variant
provided by singularity-eos. If you would like to use it, you must
implement your own custom variant.</p>
</div>
</section>
<section id="stiffened-gas">
<h3>Stiffened Gas<a class="headerlink" href="#stiffened-gas" title="Link to this heading"></a></h3>
<p>The following implementation was guided by the reference <a class="reference external" href="https://doi.org/10.1016/j.ijthermalsci.2003.09.002">StiffGas</a>. The stiffened gas model in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> takes
the form</p>
<div class="math notranslate nohighlight">
\[P = \Gamma \rho (e-q) - \gamma P_{\infty}\]</div>
<div class="math notranslate nohighlight">
\[e = \frac{ P + \gamma P_{\infty} }{ P + P_{\infty} } C_V T + q,\]</div>
<p>where quantities are largely the same as ideal gas with the exception of <span class="math notranslate nohighlight">\(P_{\infty}\)</span> and <span class="math notranslate nohighlight">\(q\)</span>, which can be thought of as an offset pressure and internal energy, respectively.</p>
<p>The entropy for a stiffened gas can be expressed as</p>
<div class="math notranslate nohighlight">
\[S = C_V \ln\left(\frac{T}{T_0}\right) + (\gamma-1) C_V \ln\left(\frac{\rho_0}
 {\rho}\right) + q',\]</div>
<p>where <span class="math notranslate nohighlight">\(S(\rho_0,T_0)=q'\)</span>. By default, <span class="math notranslate nohighlight">\(T_0 = 298\)</span> K and the
reference density is given by</p>
<div class="math notranslate nohighlight">
\[\rho_0 = \frac{P_0 + P_{\infty}}{(\gamma-1) C_V T_0},\]</div>
<p>where the reference pressure, <span class="math notranslate nohighlight">\(P_0\)</span>, is 1 bar by default.</p>
<p>The settable parameters for this EOS are the Gruneisen parameter, <span class="math notranslate nohighlight">\(\gamma-1\)</span>, specific
heat capacity, <span class="math notranslate nohighlight">\(C_V\)</span>, offset pressure, <span class="math notranslate nohighlight">\(P_{\infty}\)</span>, and the offset internal energy, <span class="math notranslate nohighlight">\(q\)</span>. Optionally, the reference state for the entropy calculation can
be provided by setting values for the reference temperature, pressure, and offset entropy (<span class="math notranslate nohighlight">\(q'\)</span>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StiffGas</span></code> EOS constructor has four arguments, <code class="docutils literal notranslate"><span class="pre">gm1</span></code>, which is
the Gruneisen parameter <span class="math notranslate nohighlight">\(\Gamma\)</span>, <code class="docutils literal notranslate"><span class="pre">Cv</span></code>, which is the
specific heat <span class="math notranslate nohighlight">\(C_V\)</span>, <code class="docutils literal notranslate"><span class="pre">P_{\infty}</span></code> which is the offset pressure, and <code class="docutils literal notranslate"><span class="pre">q</span></code> which is the offset internal energy:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">StiffGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Pinf</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the reference temperature and density for the entropy calculation,
can be provided in the constructor via <code class="docutils literal notranslate"><span class="pre">qp</span></code>, <code class="docutils literal notranslate"><span class="pre">T0</span></code>, and <code class="docutils literal notranslate"><span class="pre">P0</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">StiffGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Pinf</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that these parameters are provided solely for the entropy calculation. When
these values are not set, they will be the same as those returned by the
<code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code> function. However, if the entropy reference
conditions are given, the return values of the <code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code>
function will not be the same.</p>
<p>Both constructors also optionally accept <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter, e.g.,</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">StiffGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Pinf</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
<span class="n">StiffGas</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Pinf</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span>
<span class="w">         </span><span class="n">EntropyRho0</span><span class="p">,</span><span class="w"> </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="noble-abel">
<h3>Noble-Abel<a class="headerlink" href="#noble-abel" title="Link to this heading"></a></h3>
<p>The implementation here was influenced by the reference <a class="reference external" href="https://doi.org/10.1063/5.0079187">NobleAbel</a>. The Noble-Abel (aka Clausius I or Hirn) model in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> takes
the form</p>
<div class="math notranslate nohighlight">
\[P = \frac{ \rho (e-q) (\gamma-1) }{ 1 - b \rho }\]</div>
<div class="math notranslate nohighlight">
\[e = C_V T + q,\]</div>
<p>where quantities are similar to the ideal gas law with the exception of covolume (<span class="math notranslate nohighlight">\(b\)</span>) and offset internal energy (<span class="math notranslate nohighlight">\(q\)</span>).
It should be noted that covolume is physically significant as it represents the maximum compressibility of the gas, and as a result it should be non-negative.</p>
<p>The entropy for the Noble-Abel EoS is given by</p>
<div class="math notranslate nohighlight">
\[S = C_V \ln\left(\frac{T}{T_0}\right) + C_V (\gamma-1) \ln\left(\frac{v - b}
 {v_0 - b}\right) + q',\]</div>
<p>where <span class="math notranslate nohighlight">\(S(\rho_0,T_0)=q'\)</span>. By default, <span class="math notranslate nohighlight">\(T_0 = 298\)</span> K and the
reference density is given by</p>
<div class="math notranslate nohighlight">
\[\rho_0 = \frac{P_0}{C_V T_0(\gamma-1) + bP_0},\]</div>
<p>where <span class="math notranslate nohighlight">\(P_0\)</span> is by default 1 bar.</p>
<p>The settable parameters for this EOS are <span class="math notranslate nohighlight">\(\gamma-1\)</span>, specific
heat capacity (<span class="math notranslate nohighlight">\(C_V\)</span>), covolume (<span class="math notranslate nohighlight">\(b\)</span>) and offset internal energy (<span class="math notranslate nohighlight">\(q\)</span>). Optionally, the reference state for the entropy calculation can
be provided by setting the reference temperature, pressure, and entropy offset.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">NobleAbel</span></code> EOS constructor has four arguments: <code class="docutils literal notranslate"><span class="pre">gm1</span></code>, which is <span class="math notranslate nohighlight">\(\gamma-1\)</span>; <code class="docutils literal notranslate"><span class="pre">Cv</span></code>, the
specific heat <span class="math notranslate nohighlight">\(C_V\)</span>; <span class="math notranslate nohighlight">\(b\)</span>, the covolume; and <span class="math notranslate nohighlight">\(q\)</span>, the internal energy offset.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NobleAbel</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the reference state for the entropy calculation,
can be provided in the constructor via <code class="docutils literal notranslate"><span class="pre">qp</span></code>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> and <code class="docutils literal notranslate"><span class="pre">P0</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NobleAbel</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that these parameters are provided solely for the entropy calculation. When
these values are not set, they will be the same as those returned by the
<code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code> function. However, if the entropy reference
conditions are given, the return values of the <code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code>
function will not be the same.</p>
<p>Both constructors also optionally accept <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter, e.g.,</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">NobleAbel</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span>
<span class="w">          </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
<span class="n">NobleAbel</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span>
<span class="w">          </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="carnahan-starling">
<h3>Carnahan-Starling<a class="headerlink" href="#carnahan-starling" title="Link to this heading"></a></h3>
<p>The (quasi-exact) Carnahan-Starling model in <code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code> takes
the form</p>
<div class="math notranslate nohighlight">
\[P = Z(\rho) \rho (e-q) (\gamma-1)\]</div>
<div class="math notranslate nohighlight">
\[Z(\rho) = \frac{1+\eta+\eta^2-\eta^3}{(1-\eta)^3},\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> is the packing fraction given by</p>
<div class="math notranslate nohighlight">
\[\eta = b\rho.\]</div>
<p>The energy is related to the temperature through</p>
<div class="math notranslate nohighlight">
\[e = C_V T + q,\]</div>
<p>where <span class="math notranslate nohighlight">\(q\)</span> is an energy offset.</p>
<p>As with the Noble-Abel EOS, it should be noted that covolume is physically
significant as it represents the maximum compressibility of the gas,
and as a result it should be non-negative.</p>
<p>The Carnahan-Starling EOS is intended to represent a hard sphere fluid, and the
covolume parameter, <span class="math notranslate nohighlight">\(b\)</span>, can be related to the hard sphere
diameter, <span class="math notranslate nohighlight">\(\sigma\)</span>, through</p>
<div class="math notranslate nohighlight">
\[b = \frac{\pi}{6}\frac{\sigma^3}{M},\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the molar mass of the gas.</p>
<p>The entropy for the Carnahan-Starling EOS is given by</p>
<div class="math notranslate nohighlight">
\[S =  C_V \ln\left(\frac{T}{T_0}\right) + C_V (\gamma-1) \left\{ \ln\left(\frac{v}
 {v_0}\right) - S^{CS} \right\} + q',\]</div>
<div class="math notranslate nohighlight">
\[S^{CS} = b\left(4\left(\frac{1}{v-b} - \frac{1}{v_0-b}\right)+
  b\left(\frac{1}{(v-b)^2} - \frac{1}{(v_0-b)^2}\right)\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(S(\rho_0,T_0)=q'\)</span>. By default, <span class="math notranslate nohighlight">\(T_0 = 298\)</span> K and the
reference density is given by</p>
<div class="math notranslate nohighlight">
\[P_0 = \rho_0 Z(\rho_0) C_V T_0(\gamma-1),\]</div>
<p>where <span class="math notranslate nohighlight">\(P_0\)</span> is by default 1 bar. Denisty is obtained through root finding methods.</p>
<p>The settable parameters for this EOS are <span class="math notranslate nohighlight">\(\gamma-1\)</span>, specific
heat capacity (<span class="math notranslate nohighlight">\(C_V\)</span>), covolume (<span class="math notranslate nohighlight">\(b\)</span>) and offset internal energy (<span class="math notranslate nohighlight">\(q\)</span>). Optionally, the reference state for the entropy calculation can
be provided by setting the reference temperature, pressure, and entropy offset.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CarnahanStarling</span></code> EOS constructor has four arguments: <code class="docutils literal notranslate"><span class="pre">gm1</span></code>, which is <span class="math notranslate nohighlight">\(\gamma-1\)</span>; <code class="docutils literal notranslate"><span class="pre">Cv</span></code>, the
specific heat <span class="math notranslate nohighlight">\(C_V\)</span>; <span class="math notranslate nohighlight">\(b\)</span>, the covolume; and <span class="math notranslate nohighlight">\(q\)</span>, the internal energy offset.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CarnahanStarling</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the reference state for the entropy calculation,
can be provided in the constructor via <code class="docutils literal notranslate"><span class="pre">qp</span></code>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> and <code class="docutils literal notranslate"><span class="pre">P0</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CarnahanStarling</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that these parameters are provided solely for the entropy calculation. When
these values are not set, they will be the same as those returned by the
<code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code> function. However, if the entropy reference
conditions are given, the return values of the <code class="code docutils literal notranslate"><span class="pre">ValuesAtReferenceState()</span></code>
function will not be the same.</p>
<p>Both constructors also optionally accept <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter, e.g.,</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CarnahanStarling</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span>
<span class="w">                 </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">))</span>
<span class="n">CarnahanStarling</span><span class="p">(</span><span class="n">Real</span><span class="w"> </span><span class="n">gm1</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">qp</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span>
<span class="w">                 </span><span class="n">MeanAtomicProperties</span><span class="p">(</span><span class="n">Abar</span><span class="p">,</span><span class="w"> </span><span class="n">Zbar</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="gruneisen-eos">
<h3>Gruneisen EOS<a class="headerlink" href="#gruneisen-eos" title="Link to this heading"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not available for this EOS</p>
</div>
<p>One of the most commonly-used EOS to represent solids is the Steinberg variation
of the Mie-Gruneisen EOS, often just shortened to “Gruneisen” EOS. This EOS
uses the Hugoniot as the reference curve and thus is extremly powerful because
the basic shock response of a material can be modeled using minimal parameters.</p>
<p>The pressure follows the traditional Mie-Gruneisen form,</p>
<div class="math notranslate nohighlight">
\[P(\rho, e) = P_H(\rho) + \rho\Gamma(\rho) \left(e - e_H(\rho) \right),\]</div>
<p>Here the subscript <span class="math notranslate nohighlight">\(H\)</span> is a reminder that the reference curve is a
Hugoniot. Other quantities are defined in the <a class="reference internal" href="#available-eos-information-and-nomenclature"><span class="std std-ref">nomenclature</span></a> section.</p>
<p>The above is an incomplete equation of state because it only relates the
pressure to the density and energy, the minimum required in a solution to the
Euler equations. To complete the EOS and determine the temperature, a constant
heat capacity is assumed so that</p>
<div class="math notranslate nohighlight">
\[T(\rho, e) = \frac{e}{C_V} + T_0\]</div>
<p>The user should note that this implies that <span class="math notranslate nohighlight">\(e=0\)</span> at the reference
temperature, <span class="math notranslate nohighlight">\(T_0\)</span>. Given this simple relationship, the user should
treat the temperature from this EOS as only a rough estimate.</p>
<p>Given the inconsisetency in the temperature, we have made the choice <strong>not</strong> to
expose the entropy for this EOS. <strong>Requesting an entropy value will result in an
error.</strong></p>
<p>If a linear <span class="math notranslate nohighlight">\(U_s\)</span>-<span class="math notranslate nohighlight">\(u_p\)</span> relation is enough for your problem, we recommend using the MGUsup
EOS described below. It is a complete EOS with consistent temperature.</p>
<p>Given a reference density, <span class="math notranslate nohighlight">\(\rho_0\)</span>, we first parameterize the EOS using
<span class="math notranslate nohighlight">\(\eta\)</span> as a measure of compression given by</p>
<div class="math notranslate nohighlight">
\[\eta = 1 - \frac{\rho_0}{\rho}.\]</div>
<p>This is convenient because <span class="math notranslate nohighlight">\(eta = 0\)</span> when <span class="math notranslate nohighlight">\(\rho = \rho_0\)</span>,
<span class="math notranslate nohighlight">\(\eta = 1\)</span> at the infinite density limit, and <span class="math notranslate nohighlight">\(\eta = -\infty\)</span> at
the zero density limit. The Gruneisen parameter, <span class="math notranslate nohighlight">\(\Gamma\)</span> can be expressed
in terms of <span class="math notranslate nohighlight">\(\eta\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Gamma(\rho) =
  \begin{cases}
    \Gamma_0                                          &amp; \eta \leq 0 \\
    \Gamma_0 (1 - \eta) + b\eta                       &amp; 0 \leq \eta &lt; 1
  \end{cases}\end{split}\]</div>
<p>When the unitless user parameter <span class="math notranslate nohighlight">\(b=0\)</span>, the Gruneisen parameter is of a
form where <span class="math notranslate nohighlight">\(\rho\Gamma =\)</span> constant in compression, i.e. when
<span class="math notranslate nohighlight">\(\eta &gt; 0\)</span>.
If the unitless user parameter <span class="math notranslate nohighlight">\(b=\Gamma_0\)</span>, the Gruneisen parameter is of a
form where <span class="math notranslate nohighlight">\(\Gamma_0 =\)</span> constant in compression. These two limitig cases are
shown in the figure below.</p>
<a class="reference internal image-reference" href="../_images/SteinbergGammarho.png"><img alt="Figure: Demonstration of how the parameter b interpolated between two common approximations for Gamma" src="../_images/SteinbergGammarho.png" style="width: 500px;" />
</a>
<p>The reference pressure along the Hugoniot is determined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}P_H(\rho) = P_0 + c_0^2 \eta
  \begin{cases}
    \rho                                                  &amp; \rho &lt; \rho_0 \\
    \frac{\rho_0}{\left(
      1 - s_1 \eta - s_2 \eta^2 - s_3 \eta^3 \right)^2}   &amp; \rho \geq \rho_0
  \end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_0\)</span> is the reference pressure and <span class="math notranslate nohighlight">\(c_0\)</span>, <span class="math notranslate nohighlight">\(s_1\)</span>,
<span class="math notranslate nohighlight">\(s_2\)</span>, and <span class="math notranslate nohighlight">\(s_3\)</span> are fitting paramters to the
<span class="math notranslate nohighlight">\(U_s\)</span>-<span class="math notranslate nohighlight">\(u_p\)</span> curve such that</p>
<div class="math notranslate nohighlight">
\[U_s = c_0 + u_p \left( s_1 + s_2 \frac{u_p}{U_s}
                       + s_3\left(\frac{u_p}{U_s}\right)^2 \right).\]</div>
<p>Here <span class="math notranslate nohighlight">\(U_s\)</span> is the shock velocity and <span class="math notranslate nohighlight">\(u_p\)</span> is the particle
velocity. For many materials, this relationship is roughly linear so only the
<span class="math notranslate nohighlight">\(s_1\)</span> parameter is needed. The units for <span class="math notranslate nohighlight">\(c_0\)</span> are velocity while
the rest are unitless. Note that the parameter <span class="math notranslate nohighlight">\(s_1\)</span> is related to the
fundamental derivative of shock physics as shown by <a class="reference external" href="https://www.osti.gov/biblio/1561015">Wills</a>.</p>
<p>Finally the energy along the Hugoniot is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}E_H(\rho) =
  \begin{cases}
    0                                               &amp; \rho &lt; \rho_0 \\
    \frac{\eta (P_H + P_0)}{2 \rho_0}               &amp; \rho \geq \rho_0
  \end{cases}.\end{split}\]</div>
<p>One should note that in this form neither the expansion region nor the overall
temperature are thermodynamically consistent with the rest of the EOS. Since the
EOS is a fit to the principal Hugoniot, the EOS will obviously reproduce single
shocks quite well, but it may not be as appropriate when there are multiple
shocks or for modeling the release behavior of a material.</p>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">Gruneisen</span></code> EOS has the signature</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Gruneisen</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">C0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">G0</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho_max</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">C0</span></code> is <span class="math notranslate nohighlight">\(C_0\)</span>, <code class="docutils literal notranslate"><span class="pre">s1</span></code> is <span class="math notranslate nohighlight">\(s_1\)</span>, <code class="docutils literal notranslate"><span class="pre">s2</span></code> is
<span class="math notranslate nohighlight">\(s_2\)</span>, <code class="docutils literal notranslate"><span class="pre">s3</span></code> is <span class="math notranslate nohighlight">\(s_3\)</span>, <code class="docutils literal notranslate"><span class="pre">G0</span></code> is <span class="math notranslate nohighlight">\(\Gamma_0\)</span>, <code class="docutils literal notranslate"><span class="pre">b</span></code>
is <span class="math notranslate nohighlight">\(b\)</span>, <code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> is <span class="math notranslate nohighlight">\(T_0\)</span>,
<code class="docutils literal notranslate"><span class="pre">P0</span></code> is <span class="math notranslate nohighlight">\(P_0\)</span>, and <code class="docutils literal notranslate"><span class="pre">Cv</span></code> is <span class="math notranslate nohighlight">\(C_v\)</span>. <code class="docutils literal notranslate"><span class="pre">rho_max</span></code> is the
maximum value of density for which the reference pressure curve is
valid. Input densities above <code class="docutils literal notranslate"><span class="pre">rho_max</span></code> are pinned to <code class="docutils literal notranslate"><span class="pre">rho_max</span></code>.</p>
<p>There is an overload of the <code class="docutils literal notranslate"><span class="pre">Gruneisen</span></code> class which computes
<code class="docutils literal notranslate"><span class="pre">rho_max</span></code> automatically without the user needing to specify:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Gruneisen</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">C0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">G0</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">)</span>
</pre></div>
</div>
<p>Both constructors also optionally accept <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="extendended-vinet-eos">
<h3>Extendended Vinet EOS<a class="headerlink" href="#extendended-vinet-eos" title="Link to this heading"></a></h3>
<p>The extended Vinet EOS is a full EOS, extended in both temperature and density
from the Vinet universal EOS for solids (also called Rose cold curve). It is
expected to work well in compression but is untested in expansion. It is
published in Appendix 2 in <a class="reference external" href="https://doi.org/10.1063/1.4939675">J. Appl. Phys. 119, 015904
(2016)</a>.</p>
<p>While the Mie-Gruneisen EOS is based on a Hugoniot as reference curve, the Vinet
is based on an isotherm:</p>
<div class="math notranslate nohighlight">
\[P(\rho,T) = P_{ref}(\rho) + \alpha_0 B_0 (T - T_{ref})\]</div>
<p>where the reference isotherm is</p>
<div class="math notranslate nohighlight">
\[\begin{split}P_{ref}(X)&amp;=\frac{3 B_0}{X^2} Z \exp[\eta_0 Z] \left( 1 + \sum_{n=2}^N d_n Z^n \right) \, , \\
X &amp;= \left( \frac{\rho_0}{\rho} \right)^{1/3} \\
Z &amp;= 1-X\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(P_{ref}=0\)</span> when <span class="math notranslate nohighlight">\(\rho = \rho_0\)</span>, the reference state on
the reference isotherm is always at ambient pressure. However, the reference
isotherm is not necessarily at room temperature.</p>
<p>It can be shown that <span class="math notranslate nohighlight">\(B_0\)</span> is the isothermal bulk modulus,
and <span class="math notranslate nohighlight">\(\alpha_0\)</span> the thermal expansion coefficient, at the reference state,
and that</p>
<div class="math notranslate nohighlight">
\[\eta_0 = \frac{3}{2}\left[ \left[ \frac{\partial B}{\partial P}\right]_0 -1\right] \, .\]</div>
<p>By assuming that also the constant volume heat capacity is a constant,
<span class="math notranslate nohighlight">\({C_V}_0\)</span>, an entropy can be derived</p>
<div class="math notranslate nohighlight">
\[S(V,T) = S_0 + \alpha_0 B_0 (V - V_0) + {C_V}_0 \ln \frac{T}{T_{ref}}\]</div>
<p>and from that a thermodynamic consistent energy</p>
<div class="math notranslate nohighlight">
\[\begin{split}E(X,T) =&amp; 9 \frac{B_0 V_0}{{\eta_0}^2}\left(f_0 - \exp[\eta_0 Z] \left
(f_0 - \eta_0 Z \left(f_0 + \sum_{n=1}^N f_n Z^n \right)\right)\right) \\
        &amp; - \alpha_0 B_0 V_0 (1-X^3) T_{ref} + {C_V}_0 (T - T_{ref}) + E_0\end{split}\]</div>
<p>where the energy coefficients <span class="math notranslate nohighlight">\(f_n\)</span> are determined from the pressure
coefficients <span class="math notranslate nohighlight">\(d_n\)</span>, <span class="math notranslate nohighlight">\(n\geq 2\)</span>, by</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_N &amp;= d_N \\
f_n &amp;= d_n - \frac{n+2}{\eta_0} f_{n+1} \\
d_0 &amp;= 1.0 \\
d_1 &amp;= 0.0\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The entropy diverges to negative infinity at absolute zero due to the
constant heat capacity assumption. Care should be taken when using
temperatures significantly below that of the reference state.</p>
</div>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">Vinet</span></code> EOS has the signature</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Vinet</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">B0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">BP0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">A0</span><span class="p">,</span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">E0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="o">*</span><span class="n">expconsts</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> is <span class="math notranslate nohighlight">\(T_{ref}\)</span>, <code class="docutils literal notranslate"><span class="pre">B0</span></code> is
<span class="math notranslate nohighlight">\(B_0\)</span>, <code class="docutils literal notranslate"><span class="pre">BP0</span></code> is <span class="math notranslate nohighlight">\((\partial B/\partial P)_0\)</span>, <code class="docutils literal notranslate"><span class="pre">A0</span></code>
is <span class="math notranslate nohighlight">\(\alpha_0\)</span>, <code class="docutils literal notranslate"><span class="pre">Cv0</span></code> is <span class="math notranslate nohighlight">\({C_V}_0\)</span>, <code class="docutils literal notranslate"><span class="pre">E0</span></code> is <span class="math notranslate nohighlight">\(E_0\)</span>, <code class="docutils literal notranslate"><span class="pre">S0</span></code>
is <span class="math notranslate nohighlight">\(S_0\)</span>, and <code class="docutils literal notranslate"><span class="pre">expconsts</span></code> is a pointer to the constant array of length
39 containing the expansion coefficients
<span class="math notranslate nohighlight">\(d_2\)</span> to <span class="math notranslate nohighlight">\(d_{40}\)</span>. Expansion coefficients not used should be set to
0.0.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="mie-gruneisen-linear-u-s-u-p-eos">
<h3>Mie-Gruneisen linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> EOS<a class="headerlink" href="#mie-gruneisen-linear-u-s-u-p-eos" title="Link to this heading"></a></h3>
<p>One of the most commonly-used EOS is the linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> version of the Mie-Gruneisen EOS. This EOS
uses the Hugoniot as the reference curve and is extensively used in shock physics.
This version implements the exact thermodynamic temperature on the Hugoniot and also adds an entropy.</p>
<p>The pressure follows the traditional Mie-Gruneisen form,</p>
<div class="math notranslate nohighlight">
\[P(\rho, e) = P_H(\rho) + \rho\Gamma(\rho) \left(e - e_H(\rho) \right),\]</div>
<p>Here the subscript <span class="math notranslate nohighlight">\(H\)</span> is a reminder that the reference curve is a
Hugoniot. <span class="math notranslate nohighlight">\(\Gamma\)</span> is the Gruneisen parameter and the first approximation
is that <span class="math notranslate nohighlight">\(\rho\Gamma(\rho)=\rho_0\Gamma(\rho_0)\)</span>
which is the same assumption as in the Gruneisen EOS when <span class="math notranslate nohighlight">\(b=0\)</span>.</p>
<p>The above is an incomplete equation of state because it only relates the
pressure to the density and energy, the minimum required in a solution to the
Euler equations. To complete the EOS and determine the temperature and entropy, a constant
heat capacity is assumed so that</p>
<div class="math notranslate nohighlight">
\[T(\rho, e) = \frac{\left(e-e_H(\rho)\right)}{C_V} + T_H(\rho)\]</div>
<p>Note the difference from the Gruneisen EOS described above. We still use a constant <span class="math notranslate nohighlight">\(C_V\)</span>,
and it is usually taken at the reference temperature, but
we now extrapolate from the temperature on the Hugoniot, <span class="math notranslate nohighlight">\(T_H(\rho)\)</span>, and not
from the reference temperature, <span class="math notranslate nohighlight">\(T_0\)</span>.</p>
<p>With this consistent temperature we can derive an entropy in a similar way as for the Vinet EOS. Using
thermodynamic derivatives we can show that</p>
<div class="math notranslate nohighlight">
\[\Gamma \rho = \frac{\alpha B_T}{C_V} ,\]</div>
<p>and we arrive at</p>
<div class="math notranslate nohighlight">
\[S(\rho,T) = S_0 - \Gamma(\rho_0)C_V \eta + {C_V} \ln \frac{T}{T_0} ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> is a measure of compression given by</p>
<div class="math notranslate nohighlight">
\[\eta = 1 - \frac{\rho_0}{\rho}.\]</div>
<p>This is convenient because <span class="math notranslate nohighlight">\(\eta = 0\)</span> when <span class="math notranslate nohighlight">\(\rho = \rho_0\)</span>,
<span class="math notranslate nohighlight">\(\eta = 1\)</span> at the infinite density limit, and <span class="math notranslate nohighlight">\(\eta = -\infty\)</span> at
the zero density limit.</p>
<p>The pressure, energy, and temperature, on the Hugoniot are derived from the
shock jump conditions,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho_0 U_s &amp;= \rho (U_s - u_p) \\
P_H &amp;= \rho_0 U_s u_p \ ,\end{split}\]</div>
<p>assuming a linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> relation,</p>
<div class="math notranslate nohighlight">
\[U_s = C_s + s u_p .\]</div>
<p>Here <span class="math notranslate nohighlight">\(U_s\)</span> is the shock velocity and <span class="math notranslate nohighlight">\(u_p\)</span> is the particle
velocity. As is pointed out in the description of the Gruneisen EOS,
for many materials, the <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> relationship is roughly linear
so only this <span class="math notranslate nohighlight">\(s\)</span> parameter is needed. The units for <span class="math notranslate nohighlight">\(C_s\)</span> is velocity while
<span class="math notranslate nohighlight">\(s\)</span> is unitless. Note that the parameter <span class="math notranslate nohighlight">\(s\)</span> is related to the
fundamental derivative of shock physics as shown by <a class="reference external" href="https://www.osti.gov/biblio/1561015">Mattsson-Wills</a>.</p>
<p>Solving the jump equations above gives that the reference pressure along the Hugoniot is determined by</p>
<div class="math notranslate nohighlight">
\[P_H(\rho) = C_s^2 \rho_0 \frac{\eta}{\left(1 - s \eta \right)^2} .\]</div>
<p>Note the singularity at <span class="math notranslate nohighlight">\(s \eta = 1\)</span> which limits this model’s validity to compressions
<span class="math notranslate nohighlight">\(\eta &lt;&lt; 1/s\)</span>. If your problem can be expected to have compressions of this order, you should use the PowerMG
EOS that is explicitely constructed for large compressions.
The assumption of linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> relation is simply not valid at large compressions.</p>
<p>The energy along the Hugoniot is given by</p>
<div class="math notranslate nohighlight">
\[E_H(\rho) = \frac{P_H \eta }{2 \rho_0} + E_0 .\]</div>
<p>The temperature on the Hugoniot is hard to derive explicitely but with the help of Mathematica
we can solve</p>
<div class="math notranslate nohighlight" id="equation-th">
<span class="eqno">(1)<a class="headerlink" href="#equation-th" title="Link to this equation"></a></span>\[T_H(\rho) = T_0 e^{\Gamma(\rho_0) \eta} + \frac{e^{\Gamma(\rho_0) \eta}}{2 C_V \rho_0}
            \int_0^\eta e^{-\Gamma(\rho_0) z} z^2 \frac{d}{dz} \left( \frac{P_H}{z}\right) dz\]</div>
<p>into the explicit formula</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_H(\rho) &amp;= T_0 e^{\Gamma(\rho_0) \eta} + \frac{C_s^2}{2 C_V s^2}
          \left[\frac{- s \eta}{(1 - s \eta)^2} + \left( \frac{\Gamma(\rho_0)}{s} - 3 \right)
                                  \left( e^{\Gamma(\rho_0) \eta} - \frac{1}{(1-s \eta)}\right)\right. \\
     &amp; \ \left. + e^{-\frac{\Gamma(\rho_0)}{s} (1-s \eta)}
                  \left( Ei(\frac{\Gamma(\rho_0)}{s}(1-s \eta))-Ei(\frac{\Gamma(\rho_0)}{s}) \right)
                  \left((\frac{\Gamma(\rho_0)}{s})^2 - 4 \frac{\Gamma(\rho_0)}{s} + 2 \right) \right]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(Ei\)</span> is the exponential integral function. We replace the <span class="math notranslate nohighlight">\(Ei\)</span> difference with a sum with cutoff
giving an error less than machine precision. For <span class="math notranslate nohighlight">\(s \eta\)</span> close to <span class="math notranslate nohighlight">\(0\)</span>, there are
severe cancellations in this formula and we use the expansion</p>
<div class="math notranslate nohighlight">
\[{T_H}_{exp}(\rho) = T_0 e^{\Gamma(\rho_0) \eta} + \frac{C_s^2}{2 C_V s^2}
                      \left[ -2 \ln ( 1- s \eta) + \frac{s \eta}{(1 - s \eta)^2} ( 3 s \eta - 2) \right] \ .\]</div>
<p>The first omitted term in the expansion inside the square brackets is <span class="math notranslate nohighlight">\(\Gamma(\rho_0) \eta^4 / 6\)</span>. This expansion is
in fact even better than the common approximation of replacing the full temperature on the Hugoniot with the temperature on the
isentrope, that is, the first term <span class="math notranslate nohighlight">\(T_0 e^{\Gamma(\rho_0) \eta}\)</span>.</p>
<a class="reference internal image-reference" href="../_images/ApproxForTH.png"><img alt="Figure: Different approximations for the temperature on the Hugoniot." src="../_images/ApproxForTH.png" style="width: 500px;" />
</a>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">MGUsup</span></code> EOS has the signature</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">MGUsup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cs</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">G0</span><span class="p">,</span>
<span class="w">       </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">E0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">S0</span><span class="p">)</span>
</pre></div>
</div>
<p>where
<code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> is <span class="math notranslate nohighlight">\(T_0\)</span>,
<code class="docutils literal notranslate"><span class="pre">Cs</span></code> is <span class="math notranslate nohighlight">\(C_s\)</span>, <code class="docutils literal notranslate"><span class="pre">s</span></code> is <span class="math notranslate nohighlight">\(s\)</span>,
<code class="docutils literal notranslate"><span class="pre">G0</span></code> is <span class="math notranslate nohighlight">\(\Gamma(\rho_0)\)</span>, <code class="docutils literal notranslate"><span class="pre">Cv0</span></code> is <span class="math notranslate nohighlight">\(C_V\)</span>,
<code class="docutils literal notranslate"><span class="pre">E0</span></code> is <span class="math notranslate nohighlight">\(E_0\)</span>, and <code class="docutils literal notranslate"><span class="pre">S0</span></code> is <span class="math notranslate nohighlight">\(S_0\)</span>.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="mie-gruneisen-power-expansion-eos">
<h3>Mie-Gruneisen power expansion EOS<a class="headerlink" href="#mie-gruneisen-power-expansion-eos" title="Link to this heading"></a></h3>
<p>As we noted above, the assumption of a linear <span class="math notranslate nohighlight">\(U_s\)</span>- <span class="math notranslate nohighlight">\(u_p\)</span> relation is simply not valid at large compressions. At
Sandia National Laboratories Z-pinch machine, the compression is routinely so large that a new Mie-Gruneisen EOS was developped,
by <a class="reference external" href="https://www.osti.gov/biblio/1762624">Robinson</a>, that could handle these large compressions. The overall structure and motivation for approximations
are as described above; in compression it is only the formula for <span class="math notranslate nohighlight">\(P_H\)</span>, and by extension <span class="math notranslate nohighlight">\(T_H\)</span>, that differ. This
EOS is however modified in expansion to follow an isentrope instead of the invalid-in-expansion Hugoniot.</p>
<p>In the PowerMG model the pressure on the Hugoniot in the compression region, <span class="math notranslate nohighlight">\(\eta \geq 0\)</span> is expressed as a power series</p>
<div class="math notranslate nohighlight">
\[P_H(\rho) = K_0 \eta \left( 1 + K_1 \eta + K_2 \eta^2 + K_3 \eta^3 + \cdots + K_M \eta^M \right)\]</div>
<p>By expanding the MGUsup Hugoniot pressure into a power series in <span class="math notranslate nohighlight">\(\eta\)</span> we see that we can recover the MGUsup results by setting</p>
<div class="math notranslate nohighlight">
\[\begin{split}K_0 &amp;=&amp; C_s^2 \rho_0 \ \ \ \ \ \ \ \ &amp; \\
K_n &amp;=&amp; (n+1) s^n &amp; \ \ \ \ \ \ n &gt;= 1\end{split}\]</div>
<p>In the figure below we have used <span class="math notranslate nohighlight">\(M=20\)</span> with these coefficients and show how the divergence in the MGUsup pressure at <span class="math notranslate nohighlight">\(\eta = \frac{1}{s}\)</span> is avoided in the PowerMG, making it more suitable for modeling high pressures.</p>
<a class="reference internal image-reference" href="../_images/PMGvsMGUsupPress.png"><img alt="Figure: Comparing Hugoniot pressure for PowerMG and MGUsup" src="../_images/PMGvsMGUsupPress.png" style="width: 500px;" />
</a>
<p>For  <span class="math notranslate nohighlight">\(\eta &lt; 0\)</span>, that is, in expansion, the isentrope with a single <span class="math notranslate nohighlight">\(K_0\)</span> is used until a user defined minimum pressure is obtained</p>
<div class="math notranslate nohighlight">
\[\begin{split}P_H &amp;= K_0 \eta&amp; \ \ \ \ \ \ \ \ \ \ &amp; \frac{P_{min}}{K_0} \leq \eta &lt; 0 \\
P_H &amp;= P_{min} &amp; \ \ \ \ \ \ \ \ \ \ &amp; \eta &lt;  \frac{P_{min}}{K_0}\end{split}\]</div>
<p>If the user have not set <span class="math notranslate nohighlight">\(P_{min}\)</span> or if a positive value has been given, a default value of <span class="math notranslate nohighlight">\(P_{min} = -1000 K_0\)</span> is used.</p>
<p>If we now insert the formula for <span class="math notranslate nohighlight">\(P_H\)</span> in compression into equation <a class="reference internal" href="#equation-th">(1)</a>, for <span class="math notranslate nohighlight">\(\eta \geq 0\)</span> we arrive at</p>
<div class="math notranslate nohighlight">
\[T_H = T_0 e^{\Gamma(\rho_0) \eta} + \frac{e^{\Gamma(\rho_0) \eta}}{2 C_V \rho_0} K_0 \left( K_1 I_2 + 2 K_2 I_3 + 3 K_3 I_4 + \cdots + M K_M I_{M+1} \right)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[I_n = \int_0^\eta e^{-\Gamma(\rho_0) z} z^{n-1} dz\]</div>
<p>that can be rewritten in terms of the lower incomplete gamma function. For <span class="math notranslate nohighlight">\(\eta &lt; 0\)</span> the isentropic temperature is used,</p>
<div class="math notranslate nohighlight">
\[T_H = T_0 e^{\Gamma(\rho_0) \eta} \ \ \ \ \ \ \ \ \ \  \eta &lt; 0  \, .\]</div>
<p>It has been verified that this temperature is following the black, true temperature line in the figure late in the MGUsup section in compression and the blue isentropic temperature in expansion. More information about how to implement <span class="math notranslate nohighlight">\(T_H\)</span> into codes is given in <a class="reference external" href="https://www.osti.gov/biblio/1762624">Robinson</a>.</p>
<p>For completeness we give <span class="math notranslate nohighlight">\(E_H\)</span> as well,</p>
<div class="math notranslate nohighlight">
\[\begin{split}E_H &amp;= \frac{P_H \eta}{2 \rho_0} + E_0  &amp; \ \ \ \ \ \ \ \ \ \ &amp; \eta \geq 0 \\
E_H &amp;=  \frac{K_0 \eta^2}{2 \rho_0} + E_0 &amp; \ \ \ \ \ \ \ \ \ \ &amp; \frac{P_{min}}{K_0} \leq \eta &lt; 0 \\
E_H &amp;= \frac{K_0 \eta_{min}^2}{2 \rho_0} + E_0 + \frac{P_{min}}{\rho_0} (\eta - \eta_{min})&amp; \ \ \ \ \ \ \ \ \ \ &amp; \eta &lt;  \eta_{min} = \frac{P_{min}}{K_0}\end{split}\]</div>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">PowerMG</span></code> EOS has the signature</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">PowerMG</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">G0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">E0</span><span class="p">,</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">S0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Pmin</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="o">*</span><span class="n">expconsts</span><span class="p">)</span>
</pre></div>
</div>
<p>where
<code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> is <span class="math notranslate nohighlight">\(T_0\)</span>,
<code class="docutils literal notranslate"><span class="pre">G0</span></code> is <span class="math notranslate nohighlight">\(\Gamma(\rho_0)\)</span>, <code class="docutils literal notranslate"><span class="pre">Cv0</span></code> is <span class="math notranslate nohighlight">\(C_V\)</span>,
<code class="docutils literal notranslate"><span class="pre">E0</span></code> is <span class="math notranslate nohighlight">\(E_0\)</span>, <code class="docutils literal notranslate"><span class="pre">S0</span></code> is <span class="math notranslate nohighlight">\(S_0\)</span>, <code class="docutils literal notranslate"><span class="pre">Pmin</span></code> is <span class="math notranslate nohighlight">\(P_{min}\)</span>, and
<code class="docutils literal notranslate"><span class="pre">expconsts</span></code> is a pointer to the constant array of length
41 containing the expansion coefficients
<span class="math notranslate nohighlight">\(K_0\)</span> to <span class="math notranslate nohighlight">\(K_{40}\)</span>. Expansion coefficients not used should be set to
<span class="math notranslate nohighlight">\(0.0\)</span>.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="jwl-eos">
<h3>JWL EOS<a class="headerlink" href="#jwl-eos" title="Link to this heading"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not available for this EOS</p>
</div>
<p>The Jones-Wilkins-Lee (JWL) EOS is used mainly for detonation products of high
explosives. Similar to the other EOS here, the JWL EOS can be written in a
Mie-Gruneisen form as</p>
<div class="math notranslate nohighlight">
\[P(\rho, e) = P_S(\rho) + \rho w (e - e_S(\rho))\]</div>
<p>where the reference curve is an isentrope of the form</p>
<div class="math notranslate nohighlight">
\[P_S(\rho) = A \mathrm{e}^{-R_1 \eta} + B \mathrm{e}^{-R_2 \eta}\]</div>
<div class="math notranslate nohighlight">
\[e_S(\rho) = \frac{A}{\rho_0 R_1} \mathrm{e}^{-R_1 \eta}
            + \frac{B}{\rho_0 R_2} \mathrm{e}^{-R_2 \eta}.\]</div>
<p>Here <span class="math notranslate nohighlight">\(\eta = \frac{\rho_0}{\rho}\)</span> and <span class="math notranslate nohighlight">\(R_1\)</span>, <span class="math notranslate nohighlight">\(R_2\)</span>, <span class="math notranslate nohighlight">\(A\)</span>,
<span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(w\)</span> are constants particular to the material. Note that the
parameter <span class="math notranslate nohighlight">\(w\)</span> is simply the Gruneisen parameter and is assumed constant
for the EOS (which is fairly reasonable since the detonation products are
gasses).</p>
<p>Finally, to complete the EOS the energy is related to the temperature by</p>
<div class="math notranslate nohighlight">
\[e = e_S(\rho) + C_V T\]</div>
<p>where <span class="math notranslate nohighlight">\(C_V\)</span> is the constant volume specific heat capacity.</p>
<p>The constructor for the JWL EOS is</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">JWL</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">R1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">R2</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">A</span></code> is <span class="math notranslate nohighlight">\(A\)</span>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is <span class="math notranslate nohighlight">\(B\)</span>, <code class="docutils literal notranslate"><span class="pre">R1</span></code> is <span class="math notranslate nohighlight">\(R_1\)</span>,
<code class="docutils literal notranslate"><span class="pre">R2</span></code> is <span class="math notranslate nohighlight">\(R_2\)</span>, <code class="docutils literal notranslate"><span class="pre">w</span></code> is <span class="math notranslate nohighlight">\(w\)</span>, <code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>,
and <code class="docutils literal notranslate"><span class="pre">Cv</span></code> is <span class="math notranslate nohighlight">\(C_V\)</span>.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="davis-eos">
<h3>Davis EOS<a class="headerlink" href="#davis-eos" title="Link to this heading"></a></h3>
<p>The <a class="reference external" href="https://doi.org/10.1016/S0010-2180(99)00112-1">Davis reactants</a> and products EOS are both of
Mie-Gruneisen forms that use isentropes for the reference curves. The equations
of state are typically used to represent high explosives and their detonation
products and the reference curves are calibrated to several sets of
experimental data.</p>
<p>For both the reactants and products EOS, the pressure and energy take the forms</p>
<div class="math notranslate nohighlight">
\[P(\rho, e) = P_S(\rho) + \rho\Gamma(\rho) \left(e - e_S(\rho) \right)\]</div>
<div class="math notranslate nohighlight">
\[e(\rho, P) = e_S(\rho) + \frac{1}{\rho \Gamma(\rho)} \left(P - P_S(\rho)
  \right),\]</div>
<p>where the subscript <span class="math notranslate nohighlight">\(S\)</span> denotes quantities along the reference isentrope
and other quantities are defined in the <a class="reference internal" href="#available-eos-information-and-nomenclature"><span class="std std-ref">nomenclature</span></a> section.</p>
<section id="davis-reactants-eos">
<h4>Davis Reactants EOS<a class="headerlink" href="#davis-reactants-eos" title="Link to this heading"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not yet available for this EOS</p>
</div>
<p>The <a class="reference external" href="https://doi.org/10.1016/S0010-2180(99)00112-1">Davis reactants EOS</a> uses an isentrope passing through a
reference state and as the reference curve and then assumes that the heat
capacity varies linearly with entropy such that</p>
<div class="math notranslate nohighlight">
\[C_V = C_{V,0} + \alpha(S - S_0),\]</div>
<p>where subscript <span class="math notranslate nohighlight">\(0\)</span> refers to the reference state and <span class="math notranslate nohighlight">\(\alpha\)</span> is
a dimensionless constant specified by the user.</p>
<p>The Gruneisen parameter is given a linear form such that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Gamma(\rho) = \Gamma_0 +
  \begin{cases}
    0                 &amp; \rho &lt; \rho_0 \\
    Zy                &amp; \rho &gt;= \rho_0
  \end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(Z\)</span> is a dimensionless parameter and <span class="math notranslate nohighlight">\(y = 1 - \rho0/\rho\)</span>.
Along an isentrope, the Gruneisen parameter can be expressed as</p>
<div class="math notranslate nohighlight">
\[\Gamma_S(\rho) = \frac{\rho}{T}
                 \left(\frac{\partial T}{\partial \rho}\right)_S,\]</div>
<p>which, upon integration can produce the temperature along the reference
isentrope:</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_{S,0}(\rho) =
  \begin{cases}
    T_0\left(\frac{\rho}{\rho_0}\right)^{\Gamma_0}       &amp; \rho &lt; \rho_0 \\
    T_0\exp\left(-Zy\right)\left(\frac{\rho}{\rho_0}\right)^{\Gamma_0 + Z}
                                                         &amp; \rho &gt;= \rho_0
  \end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_{S,0}\)</span> is the temperature along the reference isentrope,
<span class="math notranslate nohighlight">\(S = S_0\)</span>.</p>
<p>Using the fact that the heat capacity can be expressed as</p>
<div class="math notranslate nohighlight">
\[C_V = T\left( \frac{\partial S}{\partial T} \right)_V,\]</div>
<p>the temperature off of the reference isoentrope can be integrated from this
identity to yield</p>
<div class="math notranslate nohighlight">
\[T(\rho, S) = T_{S,0}(\rho) \left( \frac{C_V(S)}{C_{V,0}} \right)^{\frac{1}{\alpha}},\]</div>
<p>Now requiring that the entropy go to zero at absolute zero in accordance with
the Nernst postulate and the third law of thermodynamics, the entropy can be
expressed as a function of temperature and density such that</p>
<div class="math notranslate nohighlight">
\[S(\rho, T) = \frac{C_{V,0}}{\alpha} \left( \frac{T}{T_{S,0}(\rho)} \right)^\alpha.\]</div>
<p>The <span class="math notranslate nohighlight">\(e(\rho, P)\)</span> formulation can now be more-conveniently cast in terms of
termperature such that</p>
<div class="math notranslate nohighlight">
\[e(\rho, T) = e_S(\rho) + \frac{C_{V,0} T_S(\rho)}{1 + \alpha}
  \left( \left(\frac{T}{T_S(\rho)} \right)^{1 + \alpha} - 1 \right),\]</div>
<p>which can easily be inverted to find <span class="math notranslate nohighlight">\(T(\rho, e)\)</span>.</p>
<p>Finally, the pressure and energy along the isentrope are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}P_S(\rho) = P_0 + \frac{\rho_0 A^2}{4B}
  \begin{cases}
    \exp \left( 4By \right) -1   &amp; \rho &lt; \rho_0 \\
    \sum\limits_{j=1}^3 \frac{(4By)^j}{j!} + C\frac{(4By)^4}{4!}
        + \frac{y^2}{(1-y)^4}    &amp; \rho &gt;= \rho0
  \end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[e_S(\rho) = e_0 + \int\limits_{\rho_0}^{\rho}
  \frac{P_S(\bar{\rho})}{\bar{\rho^2}}~\mathrm{d}\bar{\rho},\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(Z\)</span> are all
user-settable parameters and again quantities with a subcript of <span class="math notranslate nohighlight">\(0\)</span>
refer to the reference state. The variable <span class="math notranslate nohighlight">\(\bar{\rho}\)</span> is simply an
integration variable. The parameter <span class="math notranslate nohighlight">\(C\)</span> is especially useful for ensuring
that the high-pressure portion of the shock Hugoniot does not cross that of the
products.</p>
<p>The settable parameters are the dimensionless parameters listed above as well as
the pressure, density, temperature, energy, Gruneisen parameter, and constant
volume specific heat capacity at the reference state.</p>
<p>The constructor for the Davis Reactants EOS is</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">DavisReactants</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">rho0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">e0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">P0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">T0</span><span class="p">,</span>
<span class="w">               </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">G0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Z</span><span class="p">,</span>
<span class="w">               </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv0</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">rho0</span></code> is <span class="math notranslate nohighlight">\(\rho_0\)</span>, <code class="docutils literal notranslate"><span class="pre">e0</span></code> is <span class="math notranslate nohighlight">\(e_0\)</span>, <code class="docutils literal notranslate"><span class="pre">P0</span></code> is
<span class="math notranslate nohighlight">\(P_0\)</span>, <code class="docutils literal notranslate"><span class="pre">T0</span></code> is <span class="math notranslate nohighlight">\(T_0\)</span>, <code class="docutils literal notranslate"><span class="pre">A</span></code> is <span class="math notranslate nohighlight">\(A\)</span>, <code class="docutils literal notranslate"><span class="pre">B</span></code> is
<span class="math notranslate nohighlight">\(B\)</span>, <code class="docutils literal notranslate"><span class="pre">C</span></code> is <span class="math notranslate nohighlight">\(C\)</span>, <code class="docutils literal notranslate"><span class="pre">G0</span></code> is <span class="math notranslate nohighlight">\(\Gamma_0\)</span>, <code class="docutils literal notranslate"><span class="pre">Z</span></code> is
<span class="math notranslate nohighlight">\(Z\)</span>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is <span class="math notranslate nohighlight">\(\alpha\)</span>, and <code class="docutils literal notranslate"><span class="pre">Cv0</span></code> is the specific
heat capacity at the reference state.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
<section id="davis-products-eos">
<h4>Davis Products EOS<a class="headerlink" href="#davis-products-eos" title="Link to this heading"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not yet available for this EOS</p>
</div>
<p>The Davis products EOS is created from the reference isentrope passing through
the CJ state of the high explosive along with a constant heat capacity. The
constant heat capacity leads to the energy being a simple funciton of the
temperature deviation from the reference isentrope such that</p>
<div class="math notranslate nohighlight">
\[e(\rho, T) = e_S(\rho) + C_{V,0} (T - T_S(\rho)).\]</div>
<p>The Gruneisen parameter is given by</p>
<div class="math notranslate nohighlight">
\[\Gamma(\rho) = k - 1 + (1-b) F(\rho)\]</div>
<p>where <span class="math notranslate nohighlight">\(b\)</span> is a user-settable dimensionless parameter and <span class="math notranslate nohighlight">\(F(\rho)\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[F(\rho) = \frac{2a (\rho V_{\mathrm{C}})^n}{(\rho V_{\mathrm{C}})^{-n}
  + (\rho V_{\mathrm{C}})^n}.\]</div>
<p>Here the calibration parameters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(n\)</span> are dimensionless while
<span class="math notranslate nohighlight">\(V_{\mathrm{C}}\)</span> is given in units of specific volume.</p>
<p>Finally, the pressure, energy, and temperature along the isentrope are given by</p>
<div class="math notranslate nohighlight">
\[P_S(\rho) = P_{\mathrm{C}} G(\rho) \frac{k - 1 + F(\rho)}{k - 1 + a}\]</div>
<div class="math notranslate nohighlight">
\[e_S(\rho) = e_{\mathrm{C}} G(\rho) \frac{1}{\rho V_{\mathrm{C}}}\]</div>
<div class="math notranslate nohighlight">
\[T_S(\rho) = T_{\mathrm{C}} G(\rho) \frac{1}{(\rho V_{\mathrm{C}})^{ba + 1}}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[G(\rho) = \frac{
  \left( \frac{1}{2}(\rho V_{\mathrm{C}})^{-n}
    + \frac{1}{2}(\rho V_{\mathrm{C}})^n \right)^{a/n}}
  {(\rho V_{\mathrm{C}})^{-(k+a)}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[e_{\mathrm{C}} = \frac{P_{\mathrm{C}} V_{\mathrm{C}}}{k - 1 + a}.\]</div>
<p>Here, there are four dimensionless parameters that are settable by the user,
<span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(k\)</span>, and <span class="math notranslate nohighlight">\(n\)</span>, while <span class="math notranslate nohighlight">\(P_\mathrm{C}\)</span>,
<span class="math notranslate nohighlight">\(e_\mathrm{C}\)</span>, <span class="math notranslate nohighlight">\(V_\mathrm{C}\)</span> and <span class="math notranslate nohighlight">\(T_\mathrm{C}\)</span> are tuning
parameters with units related to their non-subscripted counterparts.</p>
<p>Note that the energy zero (i.e. the reference energy) for the Davis products EOS
is arbitrary. For the isentrope to properly pass through the CJ state of a
reacting material, the energy release of the reaction needs to be accounted for
properly. If done external to the EOS, an energy source term is required in the
Euler equations. However, a common convention is to specify the reactants and
product EOS in a consistent way such that the reference energy corresponds to
the rest state of the material <em>before</em> it reacts.</p>
<p>The energy at the CJ state can be calculated as</p>
<div class="math notranslate nohighlight">
\[e_\mathrm{CJ} = \frac{P_0 + P_\mathrm{CJ}}{2(V_0 - V_\mathrm{CJ})},\]</div>
<p>relative to <span class="math notranslate nohighlight">\(e = 0\)</span> at the reference state of the <em>reactants</em>. Therefore
the energy offset of the products EOS is given by</p>
<div class="math notranslate nohighlight">
\[e_0 = e_S(V_\mathrm{CJ}) - e_\mathrm{CJ}.\]</div>
<p>Practically, this means <span class="math notranslate nohighlight">\(e_0\)</span> should be positive for any energetic material.</p>
<p>To provide the energy offset to the Davis Products EOS, <a class="reference external" href="modifiersshiftedEOS">the energy shift
modifier</a> should be used. Note that the convention there
is that the shift is positive, so <span class="math notranslate nohighlight">\(-e_0\)</span> should be provided to the shift
modifier.</p>
<p>The constructor for the Davis Products EOS is</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">DavisProducts</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">vc</span><span class="p">,</span>
<span class="w">              </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">pc</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Real</span><span class="w"> </span><span class="n">Cv</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">a</span></code> is <span class="math notranslate nohighlight">\(a\)</span>, <code class="docutils literal notranslate"><span class="pre">b</span></code> is <span class="math notranslate nohighlight">\(b\)</span>, <code class="docutils literal notranslate"><span class="pre">k</span></code> is <span class="math notranslate nohighlight">\(k\)</span>,
<code class="docutils literal notranslate"><span class="pre">n</span></code> is <span class="math notranslate nohighlight">\(n\)</span>, <code class="docutils literal notranslate"><span class="pre">vc</span></code> is <span class="math notranslate nohighlight">\(V_\mathrm{C}\)</span>, <code class="docutils literal notranslate"><span class="pre">pc</span></code> is
<span class="math notranslate nohighlight">\(P_\mathrm{C}\)</span>, <code class="docutils literal notranslate"><span class="pre">Cv</span></code> is <span class="math notranslate nohighlight">\(C_{V,0}\)</span>.</p>
<p>This constructor also optionally accepts <cite>MeanAtomicProperties</cite> for
the atomic mass and number as a final optional parameter.</p>
</section>
</section>
<section id="spiner-eos">
<h3>Spiner EOS<a class="headerlink" href="#spiner-eos" title="Link to this heading"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not yet available for this EOS</p>
</div>
<p>Spiner EOS is a tabulated reader for the <a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">Sesame</a> database of material
equations of state. Materials include things like water, dry air,
iron, or steel. This model comes in two flavors:
<code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoT</span></code> and <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoSie</span></code>. The former
tabulates all quantities of interest in terms of density and
temperature. The latter also includes tables in terms of density and
specific internal energy.</p>
<p>Tabulating in terms of density and pressure means that computing,
e.g., pressure in terms of density and internal energy requires
solving the equation:</p>
<div class="math notranslate nohighlight">
\[e_0 = e(\rho, T)\]</div>
<p>for temperature <span class="math notranslate nohighlight">\(T\)</span> given density <span class="math notranslate nohighlight">\(\rho\)</span> and specific
internal energy <span class="math notranslate nohighlight">\(e_0\)</span>. This is in general not closed
algebraically and must be solved using a
root-find. <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoT</span></code> performs this root find in-line,
and the result is performant, thanks to library’s ability to take and
cache initial guesses. <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoSie</span></code> circumvents this
issue by tabulating in terms of both specific internal energy and
temperature.</p>
<p>Both models use (approximately) log-linear interpolation on a grid
that is (approximately) uniformly spaced on a log scale. Thermodynamic
derivatives are tabulated and interpolated, rather than computed from
the interpolating function. This approach allows for significantly
higher fidelity approximations of these derivatives.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">SpinerEOS</span></code> classes benefit from a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> parameter, as
described in <a class="reference internal" href="using-eos.html#using-eos"><span class="std std-ref">the EOS API section`</span></a>. In particular, if
an array of size 2 is passed in to the scalar call (or one per point
for the vector call), the model will leverage this scratch space to
cache initial guesses for root finds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using indexable types for your lambda, you may use
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::LogDensity</span></code> and
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::LogTemperature</span></code> for these cache
variables. Optionally, you may also expose
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::RootStatus</span></code> and <code class="docutils literal notranslate"><span class="pre">IndexableTypes::TableStatus</span></code>
for optional diagnostic variables used in root-finding.</p>
</div>
<p>To avoid race conditions, at least one array should be allocated per
thread. Depending on the call pattern, one per point may be best. In
the vector case, one per point is necessary.</p>
<p>The constructor for <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoT</span></code> is given by two overloads:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">SpinerEOSDependsRhoT</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">matid</span><span class="p">,</span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">singularity</span><span class="o">::</span><span class="n">TableSplit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">singularity</span><span class="o">::</span><span class="n">TableSplit</span><span class="o">::</span><span class="n">Total</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">bool</span><span class="w"> </span><span class="n">reproduciblity_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">bool</span><span class="w"> </span><span class="n">pmin_vapor_dome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="n">SpinerEOSDependsRhoT</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">materialName</span><span class="p">,</span>
<span class="w">                     </span><span class="k">const</span><span class="w"> </span><span class="n">singularity</span><span class="o">::</span><span class="n">TableSplit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">singularity</span><span class="o">::</span><span class="n">TableSplit</span><span class="o">::</span><span class="n">Total</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">bool</span><span class="w"> </span><span class="n">reproducibility_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">bool</span><span class="w"> </span><span class="n">pmin_vapor_dome</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
</pre></div>
</div>
<p>where here <code class="docutils literal notranslate"><span class="pre">filename</span></code> is the input file, <code class="docutils literal notranslate"><span class="pre">matid</span></code> is the unique
material ID in the database in the file, <code class="docutils literal notranslate"><span class="pre">materialName</span></code> is the name
of the material in the file, and <code class="docutils literal notranslate"><span class="pre">reproducability_mode</span></code> is a boolean
which slightly changes how initial guesses for root finds are
computed. The <code class="docutils literal notranslate"><span class="pre">TableSplit</span></code> option selects electron, ion, or total
equation of state tables for partial ionization. <code class="docutils literal notranslate"><span class="pre">pmin_vapor_dome</span></code>
specifies how to interpret the <code class="docutils literal notranslate"><span class="pre">RhoPMin</span></code> function. If it is false
(the default), it is the usual interpretation. If it is <code class="docutils literal notranslate"><span class="pre">true</span></code> and
the equation of state is Maxwell constructed, then <code class="docutils literal notranslate"><span class="pre">RhoPMin</span></code> for
this EOS will return compression edge of the vapor dome. The
constructor for <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoSie</span></code> is identical.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mean atomic mass and number are loaded from input tables. The
<code class="docutils literal notranslate"><span class="pre">SpinerEOS</span></code> model does <strong>not</strong> support the
<code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct.</p>
</div>
</section>
<section id="sp5-files-and-sesame2spiner">
<h3><code class="docutils literal notranslate"><span class="pre">sp5</span></code> files and <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code><a class="headerlink" href="#sp5-files-and-sesame2spiner" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SpinerEOS</span></code> models use their own file format built on <code class="docutils literal notranslate"><span class="pre">hdf5</span></code>,
which we call <code class="docutils literal notranslate"><span class="pre">sp5</span></code>. These files can be generated by hand, or they
can be generated from the <a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">sesame</a> database (assuming <a class="reference external" href="https://laws.lanl.gov/projects/data/eos/eospacReleases.php">eospac</a> is
installed) via the tool <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code>, which is packaged with
<code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code>. Buld <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> by specifying</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DSINGULARITY_USE_HDF5</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DSPINGULARITY_USE_EOSPAC</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DSINGULARITY_BUILD_SESAME2SPINER</span><span class="o">=</span><span class="n">ON</span>
</pre></div>
</div>
<p>at configure time. The call to <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> is of the form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sesame2spiner</span> <span class="o">-</span><span class="n">s</span> <span class="n">output_file_name</span><span class="o">.</span><span class="n">sp5</span> <span class="n">input1</span><span class="o">.</span><span class="n">dat</span> <span class="n">input2</span><span class="o">.</span><span class="n">dat</span> <span class="o">...</span>
</pre></div>
</div>
<p>for any number of input files. Verbosity flags <code class="docutils literal notranslate"><span class="pre">-p</span></code> and <code class="docutils literal notranslate"><span class="pre">-v</span></code> are
also available. Use <code class="docutils literal notranslate"><span class="pre">-h</span></code> for a help message. The <code class="docutils literal notranslate"><span class="pre">-s</span></code> flag is
optional and the output file name defaults to <code class="docutils literal notranslate"><span class="pre">materials.sp5</span></code>.</p>
<p>Each input file corresponds to a material and consists of simple
key-value pairs. For exampe the following input deck is for air:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">matid</span> <span class="o">=</span> <span class="mi">5030</span>
<span class="c1"># These set the number of grid points per decade</span>
<span class="c1"># for each variable.</span>
<span class="n">numrho</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">numT</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">numSie</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># Defaults pulled from the sesame file if possible</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">air</span>
<span class="n">rhomin</span> <span class="o">=</span> <span class="mf">1e-2</span>
<span class="n">rhomax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Tmin</span> <span class="o">=</span> <span class="mi">252</span>
<span class="n">Tmax</span> <span class="o">=</span> <span class="mf">1e4</span>
<span class="n">siemin</span> <span class="o">=</span> <span class="mf">1e12</span>
<span class="n">siemax</span> <span class="o">=</span> <span class="mf">1e16</span>
<span class="c1"># These shrink the logarithm of the bounds by a fraction of the</span>
<span class="c1"># total inteval &lt;= 1.</span>
<span class="c1"># Note that these may be deprecated in the near future.</span>
<span class="n">shrinklRhoBounds</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">shrinklTBounds</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">shrinkleBounds</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>Comments are prefixed with <code class="docutils literal notranslate"><span class="pre">#</span></code>. <a class="reference external" href="https://laws.lanl.gov/projects/data/eos/eospacReleases.php">eospac</a> uses environment variables
and files to locate files in the <a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">sesame</a> database, and
<code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> uses <a class="reference external" href="https://laws.lanl.gov/projects/data/eos/eospacReleases.php">eospac</a>. So the location of the <code class="docutils literal notranslate"><span class="pre">sesame</span></code>
database need not be provided by the command line. For how to specify
<a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">sesame</a> file locations, see the <a class="reference external" href="https://laws.lanl.gov/projects/data/eos/eospacReleases.php">eospac</a> manual.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To enable 3T subtables with <code class="docutils literal notranslate"><span class="pre">SpinerEOS</span></code>, you must set
<code class="docutils literal notranslate"><span class="pre">ionization=true</span></code> in the input file for <code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> for the
desired material.</p>
</div>
</section>
<section id="piecewise-spiner-grids">
<h3>Piecewise Spiner Grids<a class="headerlink" href="#piecewise-spiner-grids" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> also supports grids with different resolutions in
different parts of the table. We call these <strong>piecewise</strong> grids. By
default grids are now piecewise. Piecewise grids can be disabled with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># defaults are true</span>
<span class="n">piecewiseRho</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">piecewiseT</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">piecewiseSie</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<p>These options may be true or false. The default is true. When
piecewise grids are active, the density-temperature (or
density-energy) grid is built as a Cartesian product grid of grids of
non-uniform resolutions. The density grid gets split into three
pieces, a region <code class="docutils literal notranslate"><span class="pre">[rhoMin,</span> <span class="pre">rhoFineMin]</span></code>, a region <code class="docutils literal notranslate"><span class="pre">[rhoFineMin,</span>
<span class="pre">rhoFineMax]</span></code>, and a region <code class="docutils literal notranslate"><span class="pre">[rhoFineMin,</span> <span class="pre">rhoMax]</span></code>. The
<code class="docutils literal notranslate"><span class="pre">numrho/decade</span></code> parameter sets the number of points per decade in
the central refined region. The regions at lower and higher density
have <code class="docutils literal notranslate"><span class="pre">rhoCoarseFactorLo</span></code> and <code class="docutils literal notranslate"><span class="pre">rhoCoarseFactorHi</span></code> fewer points per
decade respectively compared to the finer region.</p>
<p>Typically the fine region should be roughly centered around the normal
density for a material, which is usually a challenging region to
capture. If you neglect to set <code class="docutils literal notranslate"><span class="pre">rhoFineMin</span></code> and <code class="docutils literal notranslate"><span class="pre">rhoFineMax</span></code>,
<code class="docutils literal notranslate"><span class="pre">sesame2spiner</span></code> will set the central refined region to be a region
of diameter <code class="docutils literal notranslate"><span class="pre">rhoFineDiameterDecades</span></code> (in log space) around the
material’s normal density.</p>
<p>The temperature grid has two regions, a more finely spaced region at
low temperatures and a less finely spaced region at high
temperatures. The regions are spearated by a temperature
<code class="docutils literal notranslate"><span class="pre">TSplitPoint</span></code>. The default is <span class="math notranslate nohighlight">\(10^4\)</span> Kelvin. The energy grid
follows the temperature grid, with the energy split point
corresponding to the temperature split point. The coarser
high-temperature temperature and energy grids are coarsened by a
factor of <code class="docutils literal notranslate"><span class="pre">TCoarseFactor</span></code> and <code class="docutils literal notranslate"><span class="pre">sieCoarseFactor</span></code> respectively.</p>
<p>A diagram of a density-temperature grid is shown below. The region
with temperatures below <code class="docutils literal notranslate"><span class="pre">TSplitPoint</span></code> is refined in temperature. The
region between <code class="docutils literal notranslate"><span class="pre">rhoFineMin</span></code> and <code class="docutils literal notranslate"><span class="pre">rhoFineMax</span></code> is refined in
density.</p>
<a class="reference internal image-reference" href="../_images/phase_diagram.png"><img alt="An example piecewise density-temperature grid." src="../_images/phase_diagram.png" style="width: 400px;" />
</a>
<p>Thus the input block for piecewise grid might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Below, all right-hand-sides are set to their default values.</span>
<span class="n">piecewiseRho</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">piecewiseT</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">piecewiseSie</span> <span class="o">=</span> <span class="n">true</span>

<span class="c1"># the fine resolution for rho.</span>
<span class="n">numrho</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">350</span>
<span class="c1"># width of the fine region for rho</span>
<span class="n">rhoFineDiameterDecades</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="c1"># the lower density region is 3x less refined</span>
<span class="n">rhoCoarseFactorLo</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># the higher density region is 5x less refined</span>
<span class="n">rhoCoarseFactorHi</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># the fine resolution for T</span>
<span class="n">numT</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># the point demarking the coarse and fine regions in temperature</span>
<span class="n">TSplitPoint</span> <span class="o">=</span> <span class="mf">1e4</span>
<span class="c1"># it&#39;s usually wise to to not let</span>
<span class="c1"># temperature get too small in log space if you do this</span>
<span class="n">Tmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># The coarser region (above the split point) is 50 percent less refined</span>
<span class="n">TCoarseFactor</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="c1"># energy has the split point sie(rhonormal, TSplitPoint)</span>
<span class="c1"># but we may still specify the resolution</span>
<span class="n">numSie</span><span class="o">/</span><span class="n">decade</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sieCoarseFactor</span> <span class="o">=</span> <span class="mf">1.5</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For all grid types, the only required value in an input file is the
matid. Table bounds and normal density will be inferred from the
sesame metadata if possible and if no value in the original input
file is provided. Table densities and positions and sizes of refined
regions are not inferred from the table, but are chosen with
the default values listed in the above code block.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both the flat and hierarchical grids attempt to align their grids so
that there is a grid point in density and temperature exactly at
room temperature and normal density. This is because normal density
and room temperature is a particularly important point in phase
space, as it is the point in phase space a piece of material sitting
on your desk would be at. This is called an <em>anchor</em> point for the
mesh.</p>
</div>
</section>
<section id="sap-polynomial-eos">
<h3>SAP Polynomial EOS<a class="headerlink" href="#sap-polynomial-eos" title="Link to this heading"></a></h3>
<p>This model is specific to the Safety Applications Project (SAP). It is
an incomplete EOS, and is a simple analytical form used to fit
experimental data:</p>
<div class="math notranslate nohighlight">
\[P = a_0 + a_1\mu + a_2^* \mu^2 + a_3 \mu^3 + \varepsilon(b_0 + b_1\mu + b_2^*\mu^2 + b_3\mu^3)\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\mu = \frac{\rho}{\rho_0} - 1\]</div>
<p>The constants <span class="math notranslate nohighlight">\(a_2^*\)</span> and <span class="math notranslate nohighlight">\(b_2^*\)</span> can assume different
values in expansion and compression.</p>
<div class="math notranslate nohighlight">
\[\begin{split}a_2^* = \begin{cases}
           a_2^c &amp; \mu \geq 0 \text{ (compression)}\\
           a_2^e &amp; \mu &lt;    0 \text{ (expansion)}\\
        \end{cases}\end{split}\]</div>
<p>and similar expressions for <span class="math notranslate nohighlight">\(b_2^*\)</span>.</p>
<p>The SAP polynomial EOS also optionally accepts a
<code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct.</p>
</section>
<section id="stellar-collapse-eos">
<h3>Stellar Collapse EOS<a class="headerlink" href="#stellar-collapse-eos" title="Link to this heading"></a></h3>
<p>This model provides finite temperature nuclear equations of state
suitable for core collapse supernova and compact object (such as
neutron star) simulations. These models assume nuclear statistical
equilibrium (NSE). It reads tabulated data in the <a class="reference external" href="https://stellarcollapse.org/equationofstate.html">Stellar Collapse</a>
format, as first presented by <a class="reference external" href="https://doi.org/10.1088/0264-9381/27/11/114103">OConnor and Ott</a>.</p>
<p>Like <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoT</span></code>, <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> tabulateds all
quantities in terms of density and temperature on an (approximately)
logarithmically spaced grid. And similarly, it requires an in-line
root-find to compute quantities in terms of density and specific
internal energy. Unlike most of the other models in
<code class="docutils literal notranslate"><span class="pre">singularity-eos</span></code>, <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> also depends on a third
quantity, the electron fraction,</p>
<div class="math notranslate nohighlight">
\[Y_e = \frac{n_e}{n_p + n_n}\]</div>
<p>which measures the number fraction of electrons to baryons. Symmetric
matter has a <span class="math notranslate nohighlight">\(Y_e\)</span> of 0.5, while cold neutron stars, have a
<span class="math notranslate nohighlight">\(Y_e\)</span> approximately less than 0.1.</p>
<p>As with <code class="docutils literal notranslate"><span class="pre">SpinerEOSDependsRhoT</span></code>, the Stellar Collapse tables tabulate
thermodynamic derivatives separately, rather than reconstruct them
from interpolants. However, the tabulated values can contain
artifacts, such as unphysical spikes. To mitigate this issue, the
thermodynamic derivatives are cleaned via a <a class="reference external" href="https://en.wikipedia.org/wiki/Median_filter">median filter</a>. The bulk
modulus is then recomputed from these thermodynamic derivatives via:</p>
<div class="math notranslate nohighlight">
\[B_S(\rho, T) = \rho \left(\frac{\partial P}{\partial\rho}\right)_e + \frac{P}{\rho} \left(\frac{\partial P}{\partial e}\right)_\rho\]</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> is a relativistic model, and thus the
sound speed is given by</p>
<div class="math notranslate nohighlight">
\[c_s^2 = \frac{B_S}{w}\]</div>
<p>where <span class="math notranslate nohighlight">\(w = \rho h\)</span> for specific entalpy <span class="math notranslate nohighlight">\(h\)</span> is the
enthalpy by volume, rather than the density <span class="math notranslate nohighlight">\(rho\)</span>. This ensures
the sound speed is bounded from above by the speed of light.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> model requires a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> parameter of size
2, as described in <a class="reference internal" href="using-eos.html#using-eos"><span class="std std-ref">the EOS API section`</span></a>. The zeroth
element of the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> array contains the electron fraction. The
first element is reserved for caching. It currently contains the
log of the temperature, but this should not be assumed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using the indexable type machinery, you may use
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::ElectronFraction</span></code> and
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::LogTemperature</span></code>.</p>
</div>
<p>To avoid race conditions, at least one array should be allocated per
thread. Depending on the call pattern, one per point may be best. In
the vector case, one per point is necessary.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StellarCollpase</span></code> model can read files in either the original
format found on the <a class="reference external" href="https://stellarcollapse.org/equationofstate.html">Stellar Collapse</a> website, or in the <code class="docutils literal notranslate"><span class="pre">sp5</span></code>
format described above.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the data contained in an <code class="docutils literal notranslate"><span class="pre">sp5</span></code> file for the
<code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> EOS and the <code class="docutils literal notranslate"><span class="pre">SpinerEOS</span></code> models is not
identical and the files are not interchangeable.</p>
</div>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> EOS class looks like</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">StellarCollapse</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">use_sp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">                </span><span class="kt">bool</span><span class="w"> </span><span class="n">filter_bmod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">filename</span></code> is the file containing the tabulated model,
<code class="docutils literal notranslate"><span class="pre">use_sp5</span></code> specifies whether to read an <code class="docutils literal notranslate"><span class="pre">sp5</span></code> file or a file in the
original <a class="reference external" href="https://stellarcollapse.org/equationofstate.html">Stellar Collapse</a> format, and <code class="docutils literal notranslate"><span class="pre">filter_bmod</span></code> specifies
whether or not to apply the above-described median filter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> EOS assumes nuclear statistical equilibrium
and as such mean atomic mass and number are state variables. As such
class does not accept the <code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code> struct. The
<code class="docutils literal notranslate"><span class="pre">MeanAtomicMassFromDensityTemperature</span></code> and
<code class="docutils literal notranslate"><span class="pre">MeanAtomicNumberFromDensityTemperature</span></code> functions return the
relevant quantities for some thermodynamic state. The
<code class="docutils literal notranslate"><span class="pre">MeanAtomicMass()</span></code> and <code class="docutils literal notranslate"><span class="pre">MeanAtomicNumber()</span></code> functions raise an
error.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> also provides</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv44SaveRKNSt6stringE">
<span id="_CPPv34SaveRKNSt6stringE"></span><span id="_CPPv24SaveRKNSt6stringE"></span><span id="Save__ssCR"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Save</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv44SaveRKNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<p>which saves the current EOS data in <code class="docutils literal notranslate"><span class="pre">sp5</span></code> format.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StellarCollapse</span></code> model, if used alone, also provides several
additional functions of interest for those running, e.g., supernova
simulations:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK35MassFractionsFromDensityTemperatureEK4RealK4RealR4RealR4RealR4RealR4RealR4RealP4Real">
<span id="_CPPv3NK35MassFractionsFromDensityTemperatureEK4RealK4RealR4RealR4RealR4RealR4RealR4RealP4Real"></span><span id="_CPPv2NK35MassFractionsFromDensityTemperatureEK4RealK4RealR4RealR4RealR4RealR4RealR4RealP4Real"></span><span id="MassFractionsFromDensityTemperature__RealC.RealC.RealR.RealR.RealR.RealR.RealR.RealPC"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MassFractionsFromDensityTemperature</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">temperature</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Xa</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Xn</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Xp</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Abar</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">Zbar</span></span>, <span class="n"><span class="pre">Real</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">lambda</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK35MassFractionsFromDensityTemperatureEK4RealK4RealR4RealR4RealR4RealR4RealR4RealP4Real" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<p>which returns the mass fractions for alpha particles, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, heavy
ions <code class="docutils literal notranslate"><span class="pre">Xh</span></code>, neutrons <code class="docutils literal notranslate"><span class="pre">Xn</span></code>, and protons <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, as well as the
average atomic mass <code class="docutils literal notranslate"><span class="pre">Abar</span></code> and atomic number <code class="docutils literal notranslate"><span class="pre">Zbar</span></code> for heavy
ions, assuming nuclear statistical equilibrium.</p>
<p>In addition, the user may query the bounds of the table via the
functions <code class="docutils literal notranslate"><span class="pre">rhoMin()</span></code>, <code class="docutils literal notranslate"><span class="pre">rhoMax()</span></code>, <code class="docutils literal notranslate"><span class="pre">TMin()</span></code>, <code class="docutils literal notranslate"><span class="pre">TMax()</span></code>,
<code class="docutils literal notranslate"><span class="pre">YeMin()</span></code>, <code class="docutils literal notranslate"><span class="pre">YeMax()</span></code>, <code class="docutils literal notranslate"><span class="pre">sieMin()</span></code>, and <code class="docutils literal notranslate"><span class="pre">sieMax()</span></code>, which all
return a <code class="docutils literal notranslate"><span class="pre">Real</span></code> number.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As with the SpinerEOS models, the stellar collapse models use fast
logs. You can switch the logs to true logs with the
<code class="docutils literal notranslate"><span class="pre">SINGULARITY_USE_TRUE_LOG_GRIDDING</span></code> cmake option. This may be
desirable on ARM-based architectures (e.g., <code class="docutils literal notranslate"><span class="pre">aarch64</span></code>), where
a hardware log intrinsic is available.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default implementation of our fast logs assumes little endian
numbers. If you are on a big-endian machine, they will not work
properly. If you encounter a big-endian machine, please report it
to us in the issues and (for now) enable the portable
implementation of fast logs with <code class="docutils literal notranslate"><span class="pre">-DSINGULARITY_NQT_PORTABLE=ON</span></code>.</p>
</div>
</section>
<section id="helmholtz-eos">
<h3>Helmholtz EOS<a class="headerlink" href="#helmholtz-eos" title="Link to this heading"></a></h3>
<p>This is a performance portable implementation of the Helmholtz
equation of state provided by <a class="reference external" href="https://doi.org/10.1086/313304">Timmes and Swesty</a>.  The Helmholtz EOS
is a three part thermodynamically consistent EOS for a hot, ionized
gas. It consists of a thermal radiation term:</p>
<div class="math notranslate nohighlight">
\[P = \sigma \cdot T^4\]</div>
<p>an ions term, treated as an ideal gas:</p>
<div class="math notranslate nohighlight">
\[P = (\gamma - 1) \cdot \rho \cdot e\]</div>
<p>and a degenerate electron term. Additionally, coulomb force
corrections can be applied on top of the full model.  This
multi-component model depends on the relative abundances of electrons
and ions, as well as the atomic mass and charge of the ions. As such,
the Helmholtz EOS requires two additional indepenent variables, the
average atomic mass, Abar, and the average atomic number, Zbar. These
are passed in through the lambda pointer. As with the other tabulated
EOS’s, the log of the temperature is also stored in the lambda pointer
as a cache for root finding. Helmholtz provides an enum for indexing
into the lambda:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Helmholtz::Lambda::Abar</span></code> indexes into the <code class="docutils literal notranslate"><span class="pre">Abar</span></code> component of
the lambda array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Helmholtz::Lambda::Zbar</span></code> indexes into the <code class="docutils literal notranslate"><span class="pre">Zbar</span></code> component of
the lambda array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Helmholtz::Lambda::lT</span></code> indexes into the log temperature cache
inside the lambda array.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using the indexable types machinery, you may use
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::MeanAtomicMass</span></code>,
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::MeanAtomicNumber</span></code>, and
<code class="docutils literal notranslate"><span class="pre">IndexableTypes::LogTemperature</span></code>.</p>
</div>
<p>The degenerate electron term is computed via thermodynamic derivatives
of the Helmholtz free energy (hence the name Helmholtz EOS). The free
energy is pre-computed via integrals over the Fermi sphere and
tabulated in a file provided from <a class="reference external" href="https://cococubed.com/code_pages/eos.shtml">Frank Timmes’s website</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since mean atomic mass and number are required inputs, the
<code class="docutils literal notranslate"><span class="pre">MeanAtomicMassFromDensityTemperature</span></code> and
<code class="docutils literal notranslate"><span class="pre">MeanAtomicNumberFromDensityAndTemperature</span></code> functions simply
return the input values. The <code class="docutils literal notranslate"><span class="pre">MeanAtomicMass()</span></code> and
<code class="docutils literal notranslate"><span class="pre">MeanAtomicNumber</span></code> functions produce an error.</p>
</div>
<p>The table is a simple small ascii file. To ensure thermodyanic
consistency, the table is interpolated using either biquintic or
bicubic Hermite polynomials, which are sufficiently high order that
their high-order derivatives match the underlying data.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only a modified version of the table is supported due to the fixed
number of colums in the table. This may change in the future.
The original table found on <a class="reference external" href="https://cococubed.com/code_pages/eos.shtml">Frank Timmes’s website</a> is not supported.
A compatible version of the table can be found in the
<code class="docutils literal notranslate"><span class="pre">data/helmholtz</span></code> directory of the source code, or the data
directory specified in the installation configuration.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The implication of interpolating from the free energy is that each
EOS evaluation provides ALL relevant EOS data and thermodynamic
derivatives. Thus the per-quantity EOS calls are relatively
inefficient, and it is instead better to use the FillEos call to
get the entire model at once.</p>
</div>
<p>The Helmholtz EOS is instantiated by passing in the path to the
relevant table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Helmholtz</span><span class="p">(</span><span class="n">const</span> <span class="n">std</span><span class="p">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that e.g. the Gruneisen parameter is defined differently
compared to other EOSs. Here the Gruneisen parameter is the
<span class="math notranslate nohighlight">\(\Gamma_3\)</span> of Cox &amp; Giuli 1968 - Princiiples of Stellar Structure
(c&amp;g in the following). Specifically:</p>
<div class="math notranslate nohighlight">
\[\Gamma_3 - 1 = \left. \frac{\mathrm{d} \ln T}{ \mathrm{d} \ln \rho}\right|_\mathrm{ad}\]</div>
<dl class="simple">
<dt>Some important formulas to be used when using this EOS:</dt><dd><ul class="simple">
<li><p>the temperature and density exponents (c&amp;g 9.81 9.82)</p></li>
<li><p>the specific heat at constant volume (c&amp;g 9.92)</p></li>
<li><p>the third adiabatic exponent (c&amp;g 9.93)</p></li>
<li><p>the first adiabatic exponent (c&amp;g 9.97)</p></li>
<li><p>the second adiabatic exponent (c&amp;g 9.105)</p></li>
<li><p>the specific heat at constant pressure (c&amp;g 9.98)</p></li>
<li><p>and relativistic formula for the sound speed (c&amp;g 14.29)</p></li>
</ul>
</dd>
</dl>
<p>The constructor for the <code class="docutils literal notranslate"><span class="pre">Helmholtz</span></code> EOS class looks like</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Helmholtz</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">rad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">gas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">coul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">ion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">newton_raphson</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">filename</span></code> is the file containing the tabulated model. The
optional arguments <code class="docutils literal notranslate"><span class="pre">rad</span></code>, <code class="docutils literal notranslate"><span class="pre">gas</span></code>, <code class="docutils literal notranslate"><span class="pre">coul</span></code>, <code class="docutils literal notranslate"><span class="pre">ion</span></code>, and <code class="docutils literal notranslate"><span class="pre">ele</span></code>
specify whether to include the radiation, ideal gas, coulomb correction,
ionization, and electron contributions, respectively. The default is to
include all terms. The optional argument <code class="docutils literal notranslate"><span class="pre">verbose</span></code> specifies whether to print
out additional information, e.g. when the root find fails to converge. The
optional argument <code class="docutils literal notranslate"><span class="pre">newton_raphson</span></code> specifies whether to use the Newton-Raphson
method or the regula falsi method for root finding. The default is to use the
Newton-Raphson method (note that the regula falsi method is used as a fallback
in case the Newton-Raphson method does not converge).</p>
</section>
<section id="eospac-eos">
<h3>EOSPAC EOS<a class="headerlink" href="#eospac-eos" title="Link to this heading"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Entropy is not yet available for this EOS</p>
</div>
<p>This is a striaghtforward wrapper of the <a class="reference external" href="https://laws.lanl.gov/projects/data/eos/eospacReleases.php">EOSPAC</a> library for the
<a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">Sesame</a> database. The constructor for the <code class="docutils literal notranslate"><span class="pre">EOSPAC</span></code> model has several overloads</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EOSPAC</span><span class="p">(</span><span class="nb">int</span> <span class="n">matid</span><span class="p">,</span> <span class="n">TableSplit</span> <span class="n">split</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">invert_at_setup</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span>
       <span class="n">Real</span> <span class="n">insert_data</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
       <span class="n">eospacMonotonicity</span> <span class="n">monotonicity</span> <span class="o">=</span> <span class="n">eospacMonotonicity</span><span class="p">::</span><span class="n">none</span><span class="p">,</span>
       <span class="nb">bool</span> <span class="n">apply_smoothing</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span>
       <span class="n">eospacSplit</span> <span class="n">apply_splitting</span> <span class="o">=</span> <span class="n">eospacSplit</span><span class="p">::</span><span class="n">none</span><span class="p">,</span>
       <span class="nb">bool</span> <span class="n">linear_interp</span> <span class="o">=</span> <span class="n">false</span><span class="p">);</span>
<span class="n">EOSPAC</span><span class="p">(</span><span class="nb">int</span> <span class="n">matid</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">invert_at_setup</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span> <span class="n">Real</span> <span class="n">insert_data</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
       <span class="n">eospacMonotonicity</span> <span class="n">monotonicity</span> <span class="o">=</span> <span class="n">eospacMonotonicity</span><span class="p">::</span><span class="n">none</span><span class="p">,</span>
       <span class="nb">bool</span> <span class="n">apply_smoothing</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span>
       <span class="n">eospacSplit</span> <span class="n">apply_splitting</span> <span class="o">=</span> <span class="n">eospacSplit</span><span class="p">::</span><span class="n">none</span><span class="p">,</span>
       <span class="nb">bool</span> <span class="n">linear_interp</span> <span class="o">=</span> <span class="n">false</span><span class="p">);</span>
<span class="n">EOSPAC</span><span class="p">(</span><span class="nb">int</span> <span class="n">matid</span><span class="p">,</span> <span class="n">const</span> <span class="n">Options</span> <span class="o">&amp;</span><span class="n">opts</span><span class="p">);</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">matid</span></code> is the unique material number in the database,
<code class="docutils literal notranslate"><span class="pre">split</span></code> is the <code class="docutils literal notranslate"><span class="pre">TableSplit</span></code> parameter for electron, ion, or total
tables used in partial ionization. <code class="docutils literal notranslate"><span class="pre">invert_at_setup</span></code> specifies
whether or not pre-compute tables of temperature as a function of
density and energy, <code class="docutils literal notranslate"><span class="pre">insert_data</span></code> inserts specified number of grid
points between original grid points in the <a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">Sesame</a> table,
<code class="docutils literal notranslate"><span class="pre">monotonicity`</span> <span class="pre">enforces</span> <span class="pre">monotonicity</span> <span class="pre">in</span> <span class="pre">x,</span> <span class="pre">y</span> <span class="pre">or</span> <span class="pre">both</span>
<span class="pre">(:math:`monotonicityX/Y/XY`),</span> <span class="pre">``apply_smoothing</span></code> enables data table
smoothing that imposes a linear floor on temperature dependence,
forces linear temperature dependence for low temperature, and forces
linear density dependence for low and high density,
<code class="docutils literal notranslate"><span class="pre">apply_splitting</span></code> has the following options for ion data tables not
found in the <a class="reference external" href="https://www.lanl.gov/org/ddste/aldsc/theoretical/physics-chemistry-materials/sesame-database.php">Sesame</a> database :. <span class="math notranslate nohighlight">\(splitNumProp\)</span> uses the cold
curve plus number-proportional model, <span class="math notranslate nohighlight">\(splitIdealGas\)</span> uses the
cold curve plus ideal gas model and <span class="math notranslate nohighlight">\(splitCowan\)</span> uses the cold
curve plus Cowan-nuclear model for ions and the final option
<code class="docutils literal notranslate"><span class="pre">linear_interp</span></code> uses linear instead of bilinear interpolation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mean atomic mass and number are loaded from input tables. The
<code class="docutils literal notranslate"><span class="pre">EOSPAC</span></code> model does <strong>not</strong> support the <code class="docutils literal notranslate"><span class="pre">MeanAtomicProperties</span></code>
struct.</p>
</div>
<p>Note for performance reasons this EOS uses a slightly different vector API.
See <a class="reference internal" href="using-eos.html#eospac-vector"><span class="std std-ref">EOSPAC Vector Functions</span></a> for more details.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using-eos.html" class="btn btn-neutral float-left" title="The Equation of State API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modifiers.html" class="btn btn-neutral float-right" title="Equation of State Modifiers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023. Triad National Security.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: jmm/test-pte-mem-tweak
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../goldfiles-1.6.2/src/models.html">goldfiles-1.6.2</a></dd>
      <dd><a href="../../../goldfiles-1.8.0/src/models.html">goldfiles-1.8.0</a></dd>
      <dd><a href="../../../release-1.10.0/src/models.html">release-1.10.0</a></dd>
      <dd><a href="../../../release-1.11.0/src/models.html">release-1.11.0</a></dd>
      <dd><a href="../../../release-1.6.0/src/models.html">release-1.6.0</a></dd>
      <dd><a href="../../../release-1.6.1/src/models.html">release-1.6.1</a></dd>
      <dd><a href="../../../release-1.6.2/src/models.html">release-1.6.2</a></dd>
      <dd><a href="../../../release-1.7.0/src/models.html">release-1.7.0</a></dd>
      <dd><a href="../../../release-1.8.0/src/models.html">release-1.8.0</a></dd>
      <dd><a href="../../../release-1.9.0/src/models.html">release-1.9.0</a></dd>
      <dd><a href="../../../release-1.9.1/src/models.html">release-1.9.1</a></dd>
      <dd><a href="../../../release-1.9.2/src/models.html">release-1.9.2</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../added_benchmark/src/models.html">added_benchmark</a></dd>
      <dd><a href="../../../aemattssing/src/models.html">aemattssing</a></dd>
      <dd><a href="../../../bgclayton_simple_macaw/src/models.html">bgclayton_simple_macaw</a></dd>
      <dd><a href="../../../blb/python_entropy/src/models.html">blb/python_entropy</a></dd>
      <dd><a href="../../../brryan/isothermal/src/models.html">brryan/isothermal</a></dd>
      <dd><a href="../../../cmake_fixup_static_linking/src/models.html">cmake_fixup_static_linking</a></dd>
      <dd><a href="../../../dempsey/mass_frac/src/models.html">dempsey/mass_frac</a></dd>
      <dd><a href="../../../dholladay00/cleanup_variadic/src/models.html">dholladay00/cleanup_variadic</a></dd>
      <dd><a href="../../../dholladay00/eap_debug/src/models.html">dholladay00/eap_debug</a></dd>
      <dd><a href="../../../dholladay00/faster_ses2spin/src/models.html">dholladay00/faster_ses2spin</a></dd>
      <dd><a href="../../../dholladay00/pt_solver/src/models.html">dholladay00/pt_solver</a></dd>
      <dd><a href="../../../dholladay00/xl_cuda_eospac/src/models.html">dholladay00/xl_cuda_eospac</a></dd>
      <dd><a href="../../../docs_spack_devworkflow/src/models.html">docs_spack_devworkflow</a></dd>
      <dd><a href="../../../gopsub/crest/src/models.html">gopsub/crest</a></dd>
      <dd><a href="../../../jdolence/default_shift/src/models.html">jdolence/default_shift</a></dd>
      <dd><a href="../../../jdolence/new_pte/src/models.html">jdolence/new_pte</a></dd>
      <dd><a href="../../../jhp/EAP_integration/src/models.html">jhp/EAP_integration</a></dd>
      <dd><a href="../../../jhp/two_eos/src/models.html">jhp/two_eos</a></dd>
      <dd><a href="../../../jhp/update_copyright/src/models.html">jhp/update_copyright</a></dd>
      <dd><a href="../../../jhp/using_cleanup/src/models.html">jhp/using_cleanup</a></dd>
      <dd><a href="../../hip-inline/src/models.html">jmm/hip-inline</a></dd>
      <dd><a href="../../ports-testing/src/models.html">jmm/ports-testing</a></dd>
      <dd><a href="../../rdc/src/models.html">jmm/rdc</a></dd>
      <dd><a href="../../sesame2spiner-library/src/models.html">jmm/sesame2spiner-library</a></dd>
      <dd><a href="../../sometimes-capture-by-reference/src/models.html">jmm/sometimes-capture-by-reference</a></dd>
      <dd><a href="../../spiner-introspection/src/models.html">jmm/spiner-introspection</a></dd>
      <dd><a href="../../svd/src/models.html">jmm/svd</a></dd>
      <dd><a href="../../template-lambda-sfinae-edition/src/models.html">jmm/template-lambda-sfinae-edition</a></dd>
      <dd><a href="models.html">jmm/test-pte-mem-tweak</a></dd>
      <dd><a href="../../test-stellarcollapse-fast-logs/src/models.html">jmm/test-stellarcollapse-fast-logs</a></dd>
      <dd><a href="../../units-fixes/src/models.html">jmm/units-fixes</a></dd>
      <dd><a href="../../update-clang-format/src/models.html">jmm/update-clang-format</a></dd>
      <dd><a href="../../update-kokkos-linalg/src/models.html">jmm/update-kokkos-linalg</a></dd>
      <dd><a href="../../update-spackage-1.9.1/src/models.html">jmm/update-spackage-1.9.1</a></dd>
      <dd><a href="../../../lroberts36/tilted-maxwell/src/models.html">lroberts36/tilted-maxwell</a></dd>
      <dd><a href="../../../main/src/models.html">main</a></dd>
      <dd><a href="../../../mauneyc/fix/CIcmake/src/models.html">mauneyc/fix/CIcmake</a></dd>
      <dd><a href="../../../mauneyc/fix/checkOtherHDF5ParallelFlag/src/models.html">mauneyc/fix/checkOtherHDF5ParallelFlag</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>